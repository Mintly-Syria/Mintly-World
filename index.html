<!DOCTYPE html>
<html lang="ar" dir="rtl" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mintly World - Financial Tools</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@200;300;400;600;700;900&display=swap" rel="stylesheet">

    <style>
        /* === ŸÖÿ™ÿ∫Ÿäÿ±ÿßÿ™ ÿßŸÑÿ£ŸÑŸàÿßŸÜ === */
        :root {
            /* Light Mode */
            --bg-body: #f0f2f5;
            --bg-card: #ffffff;
            --bg-header: #ffffff;
            --bg-input: #f4f6f8;
            --text-main: #2c3e50;
            --text-input: #2c3e50;
            --text-muted: #7f8c8d;
            --border: #e0e0e0;
            --accent: #d4a017; 
            --accent-hover: #b8940f;
            --accent-glow: rgba(212, 160, 23, 0.2);
            --result-color: #d4a017;
            --radius: 18px;
            --font-numbers: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            --header-height: 80px;
            --shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        /* Dark Mode */
        [data-theme="dark"] {
            --bg-body: #0f0f0f;
            --bg-card: #1a1a1a;
            --bg-header: #141414;
            --bg-input: #252525;
            --text-main: #ffd700;
            --text-input: #ffd700;
            --text-muted: #b0b0b0;
            --border: #333;
            --accent: #ffb700;
            --accent-hover: #ffcc00;
            --accent-glow: rgba(255, 183, 0, 0.15);
            --result-color: #ffd700;
            --shadow: 0 20px 40px rgba(0,0,0,0.7);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Cairo', 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            background-color: var(--bg-body);
            background-image: radial-gradient(circle at 50% -20%, var(--accent-glow) 0%, transparent 60%);
            background-attachment: fixed;
            color: var(--text-main);
            min-height: 100vh;
            width: 100%;
            padding-top: calc(var(--header-height) + 20px);
            padding-bottom: 20px;
            overflow-x: hidden;
            transition: background-color 0.3s, color 0.3s;
        }

        /* === Header === */
        .main-header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: var(--header-height);
            background-color: var(--bg-header);
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            z-index: 1000;
            box-shadow: var(--shadow);
            transition: background-color 0.3s, border-color 0.3s;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .header-logo {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid var(--accent);
            box-shadow: 0 0 15px var(--accent-glow);
            cursor: pointer;
            transition: transform 0.3s;
        }
        .header-logo:hover { transform: scale(1.05); }

        .brand-text {
            font-size: 1.2rem;
            font-weight: 900;
            color: var(--accent);
            text-transform: uppercase;
            letter-spacing: 1px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: none; 
        }
        
        .header-controls {
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 2000;
        }

        .control-btn {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-main);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1.2rem;
        }
        .control-btn:hover {
            background-color: var(--bg-input);
            border-color: var(--accent);
            color: var(--accent);
        }
        
        /* --- Language Selector Styling (Fixed Centered) --- */
        .lang-select-wrapper {
            position: relative;
            user-select: none;
            width: 40px;
            height: 40px;
        }

        .lang-select-trigger {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 1px solid var(--border);
            background: transparent;
            color: var(--text-main);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        .lang-select-trigger:hover {
            border-color: var(--accent);
            color: var(--accent);
        }
        .lang-select-trigger svg { width: 20px; height: 20px; fill: currentColor; }

        .lang-options {
            position: absolute;
            top: 55px;
            left: 50%;
            transform: translateX(-50%) scale(0.9);
            width: 220px;
            background: var(--bg-card);
            border: 2px solid var(--accent);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
            transition: all 0.2s cubic-bezier(0.165, 0.84, 0.44, 1);
            z-index: 2001;
            overflow: hidden;
            padding: 5px;
        }

        /* Active State */
        #langWrapper.open .lang-options {
            opacity: 1;
            visibility: visible;
            pointer-events: all;
            transform: translateX(-50%) scale(1);
        }

        .lang-option {
            display: flex;
            align-items: center;
            padding: 10px;
            cursor: pointer;
            border-radius: 8px;
            transition: background 0.2s;
            margin-bottom: 2px;
        }
        .lang-option:last-child { margin-bottom: 0; }
        .lang-option:hover { background-color: var(--accent-glow); }
        .lang-option img { width: 24px; height: 16px; border-radius: 2px; object-fit: cover; margin-inline-end: 10px; }
        .lang-option span { font-size: 0.9rem; font-weight: 600; }

        .header-nav {
            display: flex;
            gap: 8px;
        }

        .nav-btn {
            background: rgba(128, 128, 128, 0.1);
            border: 1px solid transparent;
            color: var(--text-muted);
            padding: 8px 14px;
            border-radius: 30px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
            white-space: nowrap;
        }

        .nav-btn.active {
            background: var(--accent);
            color: #000;
            box-shadow: 0 2px 10px var(--accent-glow);
            font-weight: 800;
        }

        /* === App Container === */
        .app-container {
            width: 100%;
            max-width: 480px;
            min-height: 60vh; 
            height: auto;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 20px; 
            box-shadow: var(--shadow);
            margin: 0 auto;
            position: relative;
            display: flex;
            flex-direction: column; 
            overflow: visible;
            transition: background-color 0.3s, border-color 0.3s;
        }

        h1 {
            text-align: center;
            font-weight: 900;
            font-size: 1.5rem; 
            margin-bottom: 15px; 
            color: var(--text-main);
            text-shadow: 0 0 10px var(--accent-glow);
            letter-spacing: -0.5px;
            flex-shrink: 0;
            user-select: none;
        }

        .view-section {
            display: none;
            flex-direction: column;
            height: auto;
            overflow: visible;
            position: relative;
        }
        
        .view-section.active-view {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .scrollable-area {
            display: block;
            overflow: visible;
            height: auto;
            width: 100%;
        }
        
        .content-wrapper {
            display: flex;
            flex-direction: column;
            padding-bottom: 20px;
        }
        
        .input-group { margin-bottom: 10px; position: relative; }
        
        label {
            display: block;
            color: var(--text-muted);
            font-size: 0.8rem;
            margin-bottom: 4px;
            font-weight: 600;
            user-select: none;
        }

        .styled-input {
            width: 100%;
            background: var(--bg-input);
            border: 2px solid var(--border);
            color: var(--text-input);
            padding: 12px 15px; 
            border-radius: var(--radius);
            font-size: 1.4rem;
            font-weight: 700;
            font-family: var(--font-numbers);
            direction: ltr;
            text-align: right;
            outline: none;
            transition: border-color 0.3s;
            -moz-appearance: textfield;
        }
        
        [dir="ltr"] .styled-input { text-align: left; }

        .styled-input::-webkit-outer-spin-button,
        .styled-input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .styled-input:focus {
            border-color: var(--accent);
            box-shadow: 0 0 0 3px var(--accent-glow);
        }

        .styled-select {
            width: 100%;
            background: var(--bg-input);
            border: 2px solid var(--border);
            color: var(--text-input);
            padding: 12px 15px; 
            border-radius: var(--radius);
            font-size: 1rem;
            font-weight: 600;
            font-family: 'Cairo', sans-serif;
            outline: none;
            transition: border-color 0.3s;
            cursor: pointer;
        }
        .styled-select:focus { border-color: var(--accent); }

        .calc-row {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }
        .calc-row .input-group { flex: 1; margin-bottom: 0; }

        .custom-select-wrapper { position: relative; user-select: none; width: 100%; z-index: 100; }
        .custom-select { position: relative; display: flex; flex-direction: column; }
        
        .custom-select__trigger {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 15px; 
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-main);
            background: var(--bg-input);
            border: 2px solid var(--border);
            border-radius: var(--radius);
            cursor: pointer;
            transition: all 0.3s;
        }

        .custom-select__trigger:hover { border-color: var(--border); }
        .custom-select.open .custom-select__trigger {
            border-color: var(--accent);
            box-shadow: 0 0 0 3px var(--accent-glow);
        }

        .arrow { font-size: 0.7rem; color: var(--text-muted); transition: transform 0.3s; pointer-events: none;}
        .custom-select.open .arrow { transform: rotate(180deg); }

        .custom-options {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            width: 90%;
            max-width: 450px;
            max-height: 80vh;
            background: var(--bg-card);
            border: 2px solid var(--accent);
            border-radius: 20px;
            box-shadow: 0 0 0 1000px rgba(0,0,0,0.8);
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
            transition: all 0.3s cubic-bezier(0.165, 0.84, 0.44, 1);
            z-index: 99999;
            display: flex;
            flex-direction: column;
            padding-bottom: 10px;
            overflow-y: auto;
        }
        .custom-select.open .custom-options {
            transform: translate(-50%, -50%) scale(1);
            opacity: 1;
            visibility: visible;
            pointer-events: all;
        }
        .custom-options::-webkit-scrollbar { width: 8px; }
        .custom-options::-webkit-scrollbar-track { background: var(--bg-input); }
        .custom-options::-webkit-scrollbar-thumb { background-color: var(--accent); border-radius: 4px; }

        .currency-search-container {
            padding: 10px 15px;
            background: var(--bg-card);
            position: sticky;
            top: 0;
            z-index: 10;
            border-bottom: 1px solid var(--border);
        }
        .currency-search {
            width: 100%;
            background: var(--bg-input);
            border: 1px solid var(--border);
            color: var(--text-input);
            padding: 10px 15px;
            border-radius: 12px;
            font-size: 0.9rem;
            font-family: 'Cairo', sans-serif;
            outline: none;
            transition: 0.3s;
        }
        .currency-search:focus { border-color: var(--accent); }

        .custom-option {
            position: relative;
            display: flex;
            align-items: center;
            padding: 15px 20px;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.2s;
            border-bottom: 1px solid rgba(128,128,128,0.1);
        }
        .custom-option:last-child { border-bottom: none; }
        .custom-option:hover {
            background-color: var(--accent-glow);
            color: var(--text-main);
            padding-right: 25px;
        }
        .custom-option.selected {
            color: var(--accent);
            background-color: var(--accent-glow);
        }

        .flag-icon {
            width: 32px;
            height: 24px;
            object-fit: contain; 
            border-radius: 4px;
            margin-left: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
            background-color: #333;
            pointer-events: none;
        }
        [dir="ltr"] .flag-icon { margin-left: 0; margin-right: 15px; }

        .currency-text { flex: 1; text-align: right; direction: ltr; pointer-events: none;}
        [dir="ltr"] .currency-text { text-align: left; }
        
        .ar-name, .en-name {
            display: block;
            color: var(--text-muted);
            font-size: 0.8em;
            margin-top: 3px;
            direction: rtl; 
            text-align: right;
        }
        [dir="ltr"] .ar-name, [dir="ltr"] .en-name { direction: ltr; text-align: left; }

        .swap-row { display: flex; justify-content: center; margin: -5px 0 10px 0; position: relative; z-index: 1; }
        .btn-swap {
            width: 40px;
            height: 40px; 
            border-radius: 50%;
            background: var(--bg-card);
            border: 2px solid var(--border);
            color: var(--text-muted);
            font-size: 1.1rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }
        .btn-swap:hover {
            color: var(--accent);
            border-color: var(--accent);
            transform: rotate(180deg) scale(1.1);
            box-shadow: 0 0 15px var(--accent-glow);
        }

        .footer-actions {
            margin-top: 20px; 
        }

        .btn-convert {
            width: 100%;
            padding: 14px; 
            background: linear-gradient(135deg, var(--accent), var(--accent-hover));
            color: #000;
            border: none;
            border-radius: var(--radius);
            font-size: 1.1rem;
            font-weight: 800;
            cursor: pointer;
            margin-top: 5px;
            box-shadow: 0 5px 15px -5px var(--accent-glow);
            transition: transform 0.2s, box-shadow 0.2s;
            user-select: none;
        }
        .btn-convert:active { transform: scale(0.98); }

        .result-box {
            margin-top: 10px; 
            padding-top: 15px;
            border-top: 1px solid var(--border);
            text-align: center;
            opacity: 0;
            transform: translateY(15px);
            transition: all 0.5s;
        }
        .result-box.show { opacity: 1; transform: translateY(0); }
        
        .result-amount {
            font-size: 2.2rem; 
            font-weight: 900;
            color: var(--result-color);
            line-height: 1.1;
            margin-bottom: 2px;
            text-shadow: 0 0 20px var(--accent-glow);
            font-family: var(--font-numbers);
            word-break: break-all;
        }
        .rate-display {
            font-size: 0.8rem;
            color: var(--text-muted);
            background: var(--bg-input);
            padding: 4px 12px;
            border-radius: 50px;
            border: 1px solid var(--border);
            display: inline-block;
            margin-top: 5px;
        }

        .refresh-btn {
            background: transparent;
            border: 1px solid var(--accent);
            color: var(--accent);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.8rem;
            cursor: pointer;
            margin-bottom: 15px;
            align-self: flex-end;
            display: flex;
            align-items: center;
            gap: 5px;
            user-select: none;
        }
        .refresh-btn:hover { background: var(--accent); color: #000; }
        .refresh-btn svg { width: 14px; height: 14px; pointer-events: none; }

        .metal-card {
            background: var(--bg-input);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 20px;
            margin-bottom: 20px;
            text-align: center;
            user-select: none;
        }
        .metal-card.gold { border-color: #ffd700; }
        .metal-card.silver { border-color: #c0c0c0; }
        
        .metal-icon { font-size: 2rem; margin-bottom: 10px; }
        .metal-title { font-size: 1.2rem; font-weight: 700; margin-bottom: 15px; }
        .gold .metal-title { color: #ffd700; }
        .silver .metal-title { color: #e0e0e0; }

        .price-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid rgba(128,128,128,0.1);
            font-family: var(--font-numbers);
            font-weight: 600;
        }
        .price-row:last-child { border-bottom: none; }
        .price-label { color: var(--text-muted); font-size: 0.9rem; }
        .price-value { font-size: 1rem; color: var(--text-main); }

        .crypto-list { display: flex; flex-direction: column; gap: 10px; padding-bottom: 20px; }
        .crypto-item {
            background: var(--bg-input);
            padding: 15px;
            border-radius: var(--radius);
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid var(--border);
            user-select: none;
        }
        .crypto-info { display: flex; align-items: center; gap: 12px; }
        .crypto-icon { width: 36px; height: 36px; border-radius: 50%; background: #333; pointer-events: none;}
        .crypto-name { font-weight: 700; font-size: 1rem; color: var(--text-main); }
        .crypto-symbol { color: var(--text-muted); font-size: 0.8rem; }
        .crypto-price { 
            font-family: var(--font-numbers); 
            font-weight: 700; 
            color: var(--accent);
        }

        .live-indicator {
            font-size: 0.7rem;
            color: #0f0;
            display: flex;
            align-items: center;
            gap: 4px;
            margin-bottom: 10px;
            animation: blink 1.5s infinite;
        }
        @keyframes blink { 50% { opacity: 0.5; } }

        .loader {
            display: none;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(0,0,0,0.3);
            border-radius: 50%;
            border-top-color: #000;
            animation: spin 0.8s linear infinite;
            margin: 20px auto;
        }
        @keyframes spin { 100% { transform: rotate(360deg); } }

        .toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: var(--bg-card);
            color: var(--text-main);
            border: 1px solid var(--accent);
            padding: 10px 20px;
            border-radius: 50px;
            font-weight: 700;
            box-shadow: 0 10px 25px rgba(0,0,0,0.5);
            transition: 0.4s;
            z-index: 100000;
            font-size: 0.85rem;
            pointer-events: none;
        }
        .toast.active { transform: translateX(-50%) translateY(0); }

        .close-modal {
            text-align: center;
            padding: 15px;
            color: var(--accent);
            font-size: 1.2rem;
            cursor: pointer;
            border-bottom: 1px solid var(--border);
            margin-bottom: 0px;
            flex-shrink: 0;
            user-select: none;
        }
        .close-modal:active { opacity: 0.7; }
        
        .section-loader {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            color: var(--text-muted);
            min-height: 200px;
        }
        
        @media (min-width: 400px) {
            .brand-text { display: block; }
        }
    </style>
</head>
<body>

    <!-- Header -->
    <header class="main-header">
        <div class="header-left">
            <img src="https://i.postimg.cc/SKQnQvN0/f178c888-f04a-4103-832e-d9c0e717cc2d.png" class="header-logo" alt="Mintly Logo" onclick="switchView('home', document.querySelector('.nav-btn'))">
            <span class="brand-text">Mintly World</span>
        </div>
        
        <nav class="header-nav">
            <button class="nav-btn active" data-i18n="nav_currencies" onclick="switchView('home', this)">ÿπŸÖŸÑÿßÿ™</button>
            <button class="nav-btn" data-i18n="nav_gold" onclick="switchView('gold', this)">ÿßŸÑÿ∞Ÿáÿ®</button>
            <button class="nav-btn" data-i18n="nav_crypto" onclick="switchView('crypto', this)">ÿßŸÑÿ±ŸÇŸÖŸäÿ©</button>
        </nav>

        <div class="header-controls">
            <!-- Language Selector (Fixed Centered) -->
            <div class="lang-select-wrapper" id="langWrapper">
                <div class="lang-select-trigger" id="langTrigger">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM11 19.93C7.05 19.44 4 16.08 4 12C4 11.38 4.08 10.79 4.21 10.21L9 15V16C9 17.1 9.9 18 11 18V19.93ZM17.9 17.39C17.64 16.8 16.9 16 16 16H15V13C15 12.45 14.55 12 14 12H8V10H10C10.55 10 11 9.55 11 9V7H13C14.1 7 15 6.1 15 5V4.59C17.93 5.78 20 8.65 20 12C20 14.08 19.2 15.97 17.9 17.39Z"/>
                    </svg>
                </div>
                <div class="lang-options" id="langOptions">
                    <!-- Populated by JS -->
                </div>
            </div>

            <button class="control-btn" id="themeToggle" onclick="toggleTheme()">
                <span id="themeIcon">‚òÄÔ∏è</span>
            </button>
        </div>
    </header>

    <!-- App Container -->
    <div class="app-container">

        <!-- View 1: Converter -->
        <div id="view-home" class="view-section active-view">
            <h1 data-i18n="title_converter">ŸÖÿ≠ŸàŸÑ ÿßŸÑÿπŸÖŸÑÿßÿ™</h1>
            
            <div class="scrollable-area">
                <div class="content-wrapper">
                    <div class="input-group">
                        <label data-i18n="label_amount">ÿßŸÑŸÖÿ®ŸÑÿ∫ (Amount)</label>
                        <input type="number" id="amount" class="styled-input" value="1" placeholder="0.00" lang="en" inputmode="decimal">
                    </div>

                    <div class="input-group">
                        <label data-i18n="label_from">ŸÖŸÜ (From)</label>
                        <div class="custom-select-wrapper">
                            <div class="custom-select" id="fromSelect">
                                <div class="custom-select__trigger">
                                    <span data-i18n="select_currency">ÿßÿÆÿ™ÿ± ÿßŸÑÿπŸÖŸÑÿ©</span>
                                    <span class="arrow">‚ñº</span>
                                </div>
                                <div class="custom-options"></div>
                            </div>
                        </div>
                    </div>

                    <div class="swap-row">
                        <button class="btn-swap" id="swapBtn">‚áÑ</button>
                    </div>

                    <div class="input-group">
                        <label data-i18n="label_to">ÿ•ŸÑŸâ (To)</label>
                        <div class="custom-select-wrapper">
                            <div class="custom-select" id="toSelect">
                                <div class="custom-select__trigger">
                                    <span data-i18n="select_currency">ÿßÿÆÿ™ÿ± ÿßŸÑÿπŸÖŸÑÿ©</span>
                                    <span class="arrow">‚ñº</span>
                                </div>
                                <div class="custom-options"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="footer-actions">
                <button class="btn-convert" id="convertBtn">
                    <span class="btn-text" data-i18n="btn_convert">ÿ™ÿ≠ŸàŸäŸÑ</span>
                    <div class="loader" id="loader"></div>
                </button>

                <div class="result-box" id="resultBox">
                    <div class="result-amount" id="resultAmount" lang="en">0.00</div>
                    <div class="rate-display" id="rateDisplay" lang="en">1 USD = --- USD</div>
                </div>
            </div>
        </div>

        <!-- View 2: Gold -->
        <div id="view-gold" class="view-section">
            <div style="display:flex; flex-direction:column; width:100%;">
                <div style="flex-shrink: 0;">
                    <h1 data-i18n="title_metals">ÿ£ÿ≥ÿπÿßÿ± ÿßŸÑŸÖÿπÿßÿØŸÜ</h1>
                    
                    <button class="refresh-btn" onclick="fetchGoldAndSilver()">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 4v6h-6"></path><path d="M1 20v-6h6"></path><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path></svg>
                        <span data-i18n="btn_refresh">ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ¢ŸÜ</span>
                    </button>
                </div>

                <div id="gold-loader-container" class="section-loader" style="display:none">
                    <div class="loader" style="display:block; border-top-color:var(--accent); border-color:rgba(212, 160, 23, 0.3);"></div>
                    <div style="margin: 0 10px" data-i18n="loading">ÿ¨ÿßÿ±Ÿä ÿ™ÿ≠ŸÖŸäŸÑ...</div>
                </div>

                <div class="scrollable-area">
                    <div id="gold-content" style="display:none;">
                        
                        <div class="metal-card gold" style="border-color: var(--accent);">
                            <div class="metal-title" data-i18n="title_calc">ÿ≠ÿßÿ≥ÿ®ÿ© ŸÇŸäŸÖÿ© ÿßŸÑÿ∞Ÿáÿ®</div>
                            
                            <div class="calc-row">
                                <div class="input-group">
                                    <label data-i18n="label_weight">ÿßŸÑŸàÿ≤ŸÜ (ÿ∫ÿ±ÿßŸÖ)</label>
                                    <input type="number" id="calc-weight" class="styled-input" placeholder="10" inputmode="decimal">
                                </div>
                                <div class="input-group">
                                    <label data-i18n="label_karat">ÿßŸÑÿπŸäÿßÿ±</label>
                                    <select id="calc-karat" class="styled-select">
                                        <option value="24">24K</option>
                                        <option value="22" selected>22K</option>
                                        <option value="21">21K</option>
                                        <option value="18">18K</option>
                                        <option value="14">14K</option>
                                    </select>
                                </div>
                            </div>

                            <div class="input-group">
                                <label data-i18n="label_currency">ÿßŸÑÿπŸÖŸÑÿ©</label>
                                <div class="custom-select-wrapper">
                                    <div class="custom-select" id="calcCurrencySelect">
                                        <div class="custom-select__trigger">
                                            <span data-i18n="select_currency">ÿßÿÆÿ™ÿ± ÿßŸÑÿπŸÖŸÑÿ©</span>
                                            <span class="arrow">‚ñº</span>
                                        </div>
                                        <div class="custom-options"></div>
                                    </div>
                                </div>
                            </div>

                            <button class="btn-convert" onclick="calculateGoldValue()" style="margin-top:15px;">
                                <span class="btn-text" data-i18n="btn_calc">ÿßÿ≠ÿ≥ÿ® ÿßŸÑÿ≥ÿπÿ±</span>
                            </button>

                            <div class="result-box" id="calc-result-box" style="margin-top:15px; border-top:none; padding-top:5px;">
                                <div style="font-size:0.8rem; color:var(--text-muted); margin-bottom:5px;" data-i18n="label_approx">ÿßŸÑŸÇŸäŸÖÿ© ÿßŸÑÿ™ŸÇÿ±Ÿäÿ®Ÿäÿ©:</div>
                                <div class="result-amount" id="calc-result-amount" lang="en">0.00</div>
                                <div class="rate-display" id="calc-currency-label" style="margin-top:5px;">---</div>
                            </div>
                        </div>

                        <div class="metal-card gold">
                            <div class="metal-icon">ü•á</div>
                            <div class="metal-title" data-i18n="market_prices">ÿ£ÿ≥ÿπÿßÿ± ÿßŸÑÿ≥ŸàŸÇ ÿßŸÑÿπÿßŸÑŸÖŸäÿ©</div>
                            
                            <div class="price-row">
                                <span class="price-label" data-i18n="ounce_usd">ÿ£ŸàŸÜÿµÿ© (ÿØŸàŸÑÿßÿ±)</span>
                                <span class="price-value" id="gold-ounce-usd">---</span>
                            </div>
                            <div class="price-row">
                                <span class="price-label" data-i18n="gram_24_usd">ÿ∫ÿ±ÿßŸÖ 24 (ÿØŸàŸÑÿßÿ±)</span>
                                <span class="price-value" id="gold-gram-usd">---</span>
                            </div>
                            <div class="price-row" style="margin-top:5px; border-top:1px dashed var(--border); padding-top:5px;">
                                <span class="price-label" data-i18n="ounce_syp">ÿ£ŸàŸÜÿµÿ© (ŸÑŸäÿ±ÿ© ÿ≥Ÿàÿ±Ÿäÿ©)</span>
                                <span class="price-value" id="gold-ounce-syp" style="color:var(--accent)">---</span>
                            </div>
                            <div class="price-row">
                                <span class="price-label" data-i18n="gram_21_syp">ÿ∫ÿ±ÿßŸÖ 21 (ŸÑŸäÿ±ÿ© ÿ≥Ÿàÿ±Ÿäÿ©)</span>
                                <span class="price-value" id="gold-21-syp" style="color:var(--accent)">---</span>
                            </div>
                        </div>

                        <div class="metal-card silver">
                            <div class="metal-icon">ü•à</div>
                            <div class="metal-title" data-i18n="silver_title">ÿßŸÑŸÅÿ∂ÿ© (Silver)</div>
                            
                            <div class="price-row">
                                <span class="price-label" data-i18n="ounce_usd">ÿ£ŸàŸÜÿµÿ© (ÿØŸàŸÑÿßÿ±)</span>
                                <span class="price-value" id="silver-ounce-usd">---</span>
                            </div>
                            <div class="price-row">
                                <span class="price-label" data-i18n="gram_usd">ÿ∫ÿ±ÿßŸÖ (ÿØŸàŸÑÿßÿ±)</span>
                                <span class="price-value" id="silver-gram-usd">---</span>
                            </div>
                        </div>
                        
                        <p style="text-align:center; font-size:0.7rem; color:var(--text-muted); margin-top:20px; line-height:1.6; padding-bottom: 20px;">
                            * <span data-i18n="disclaimer">ÿßŸÑÿ£ÿ≥ÿπÿßÿ± ÿ™Ÿèÿ¨ŸÑÿ® ŸÖŸÜ ŸÖÿµÿßÿØÿ± ÿØŸÇŸäŸÇÿ©.</span><br>
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- View 3: Crypto -->
        <div id="view-crypto" class="view-section">
            <div style="display:flex; flex-direction:column; width:100%;">
                <div style="flex-shrink: 0;">
                    <h1 data-i18n="nav_crypto">ÿßŸÑÿπŸÖŸÑÿßÿ™ ÿßŸÑÿ±ŸÇŸÖŸäÿ©</h1>
                    
                    <div class="live-indicator" style="display:none" id="crypto-live-indicator">
                        <div style="width:8px; height:8px; background:#0f0; border-radius:50%"></div>
                        <span data-i18n="live_prices">ÿßŸÑÿ£ÿ≥ÿπÿßÿ± ÿ™ÿ™ÿ≠ÿØÿ´ ÿ™ŸÑŸÇÿßÿ¶ŸäÿßŸã</span>
                    </div>

                    <div id="crypto-loader-container" class="section-loader" style="display:none">
                        <div class="loader" style="display:block; border-top-color:var(--accent); border-color:rgba(212, 160, 23, 0.3);"></div>
                        <div style="margin: 0 10px" data-i18n="loading">ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ™ÿ≠ŸÖŸäŸÑ ...</div>
                    </div>
                </div>

                <div class="scrollable-area">
                    <div class="crypto-list" id="cryptoListContainer">
                        <div style="text-align:center; padding:20px; color:var(--text-muted);" data-i18n="loading"> ÿ¨ÿßÿ±Ÿä ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™... </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <div class="toast" id="toast">Alert Message</div>

    <script>
        // === Supported Languages ===
        const supportedLanguages = {
            ar: { name: "ÿßŸÑÿπÿ±ÿ®Ÿäÿ©", flag: "sa" },
            en: { name: "English", flag: "us" },
            es: { name: "Espa√±ol", flag: "es" },
            fr: { name: "Fran√ßais", flag: "fr" },
            de: { name: "Deutsch", flag: "de" },
            zh: { name: "‰∏≠Êñá", flag: "cn" },
            ja: { name: "Êó•Êú¨Ë™û", flag: "jp" },
            ru: { name: "–†—É—Å—Å–∫–∏–π", flag: "ru" },
            pt: { name: "Portugu√™s", flag: "pt" },
            hi: { name: "‡§π‡§ø‡§®‡•ç‡§¶‡•Ä", flag: "in" },
            it: { name: "Italiano", flag: "it" }
        };

        // === Full Translations ===
        const translations = {
            ar: {
                nav_currencies: "ÿπŸÖŸÑÿßÿ™", nav_gold: "ÿßŸÑÿ∞Ÿáÿ®", nav_crypto: "ÿßŸÑÿ±ŸÇŸÖŸäÿ©",
                title_converter: "ŸÖÿ≠ŸàŸÑ ÿßŸÑÿπŸÖŸÑÿßÿ™", label_amount: "ÿßŸÑŸÖÿ®ŸÑÿ∫ (Amount)",
                select_currency: "ÿßÿÆÿ™ÿ± ÿßŸÑÿπŸÖŸÑÿ©", label_from: "ŸÖŸÜ (From)", label_to: "ÿ•ŸÑŸâ (To)",
                btn_convert: "ÿ™ÿ≠ŸàŸäŸÑ", title_metals: "ÿ£ÿ≥ÿπÿßÿ± ÿßŸÑŸÖÿπÿßÿØŸÜ", btn_refresh: "ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ¢ŸÜ",
                loading: "ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ™ÿ≠ŸÖŸäŸÑ...", title_calc: "ÿ≠ÿßÿ≥ÿ®ÿ© ŸÇŸäŸÖÿ© ÿßŸÑÿ∞Ÿáÿ®",
                label_weight: "ÿßŸÑŸàÿ≤ŸÜ (ÿ∫ÿ±ÿßŸÖ)", label_karat: "ÿßŸÑÿπŸäÿßÿ±", label_currency: "ÿßŸÑÿπŸÖŸÑÿ©",
                btn_calc: "ÿßÿ≠ÿ≥ÿ® ÿßŸÑÿ≥ÿπÿ±", label_approx: "ÿßŸÑŸÇŸäŸÖÿ© ÿßŸÑÿ™ŸÇÿ±Ÿäÿ®Ÿäÿ©:",
                market_prices: "ÿ£ÿ≥ÿπÿßÿ± ÿßŸÑÿ≥ŸàŸÇ ÿßŸÑÿπÿßŸÑŸÖŸäÿ©", ounce_usd: "ÿ£ŸàŸÜÿµÿ© (ÿØŸàŸÑÿßÿ±)",
                gram_24_usd: "ÿ∫ÿ±ÿßŸÖ 24 (ÿØŸàŸÑÿßÿ±)", ounce_syp: "ÿ£ŸàŸÜÿµÿ© (ŸÑŸäÿ±ÿ© ÿ≥Ÿàÿ±Ÿäÿ©)",
                gram_21_syp: "ÿ∫ÿ±ÿßŸÖ 21 (ŸÑŸäÿ±ÿ© ÿ≥Ÿàÿ±Ÿäÿ©)", silver_title: "ÿßŸÑŸÅÿ∂ÿ© (Silver)",
                gram_usd: "ÿ∫ÿ±ÿßŸÖ (ÿØŸàŸÑÿßÿ±)", disclaimer: "ÿßŸÑÿ£ÿ≥ÿπÿßÿ± ÿ™Ÿèÿ¨ŸÑÿ® ŸÖŸÜ ŸÖÿµÿßÿØÿ± ÿØŸÇŸäŸÇÿ©.",
                live_prices: "ÿßŸÑÿ£ÿ≥ÿπÿßÿ± ÿ™ÿ™ÿ≠ÿØÿ´ ÿ™ŸÑŸÇÿßÿ¶ŸäÿßŸã"
            },
            en: {
                nav_currencies: "Currencies", nav_gold: "Gold", nav_crypto: "Crypto",
                title_converter: "Currency Converter", label_amount: "Amount",
                select_currency: "Select Currency", label_from: "From", label_to: "To",
                btn_convert: "Convert", title_metals: "Metal Prices", btn_refresh: "Refresh Now",
                loading: "Loading...", title_calc: "Gold Value Calculator",
                label_weight: "Weight (Grams)", label_karat: "Karat", label_currency: "Currency",
                btn_calc: "Calculate", label_approx: "Approx. Value:",
                market_prices: "Global Market Prices", ounce_usd: "Ounce (USD)",
                gram_24_usd: "Gram 24 (USD)", ounce_syp: "Ounce (SYP)",
                gram_21_syp: "Gram 21 (SYP)", silver_title: "Silver",
                gram_usd: "Gram (USD)", disclaimer: "Prices are fetched from reliable sources.",
                live_prices: "Live Prices Updating"
            },
            es: {
                nav_currencies: "Monedas", nav_gold: "Oro", nav_crypto: "Cripto",
                title_converter: "Conversor de Divisas", label_amount: "Cantidad",
                select_currency: "Seleccionar Moneda", label_from: "De", label_to: "A",
                btn_convert: "Convertir", title_metals: "Precios de Metales", btn_refresh: "Actualizar",
                loading: "Cargando...", title_calc: "Calculadora de Oro",
                label_weight: "Peso (Gramos)", label_karat: "Quilates", label_currency: "Moneda",
                btn_calc: "Calcular", label_approx: "Valor Aprox:",
                market_prices: "Precios Globales", ounce_usd: "Onza (USD)",
                gram_24_usd: "Gramo 24 (USD)", ounce_syp: "Onza (SYP)",
                gram_21_syp: "Gramo 21 (SYP)", silver_title: "Plata",
                gram_usd: "Gramo (USD)", disclaimer: "Los precios se obtienen de fuentes fiables.",
                live_prices: "Actualizaci√≥n en vivo"
            },
            fr: {
                nav_currencies: "Devises", nav_gold: "Or", nav_crypto: "Crypto",
                title_converter: "Convertisseur de Devises", label_amount: "Montant",
                select_currency: "S√©lectionner Devise", label_from: "De", label_to: "√Ä",
                btn_convert: "Convertir", title_metals: "Prix des M√©taux", btn_refresh: "Actualiser",
                loading: "Chargement...", title_calc: "Calculateur d'Or",
                label_weight: "Poids (Grammes)", label_karat: "Carat", label_currency: "Devise",
                btn_calc: "Calculer", label_approx: "Valeur Approx:",
                market_prices: "Prix Mondiaux", ounce_usd: "Once (USD)",
                gram_24_usd: "Gramme 24 (USD)", ounce_syp: "Once (SYP)",
                gram_21_syp: "Gramme 21 (SYP)", silver_title: "Argent",
                gram_usd: "Gramme (USD)", disclaimer: "Les prix proviennent de sources fiables.",
                live_prices: "Mise √† jour en direct"
            },
            de: {
                nav_currencies: "W√§hrungen", nav_gold: "Gold", nav_crypto: "Krypto",
                title_converter: "W√§hrungsrechner", label_amount: "Betrag",
                select_currency: "W√§hrung w√§hlen", label_from: "Von", label_to: "Nach",
                btn_convert: "Umrechnen", title_metals: "Edelmetallpreise", btn_refresh: "Aktualisieren",
                loading: "Laden...", title_calc: "Goldrechner",
                label_weight: "Gewicht (Gramm)", label_karat: "Karat", label_currency: "W√§hrung",
                btn_calc: "Berechnen", label_approx: "Ungef√§hrer Wert:",
                market_prices: "Weltmarktpreise", ounce_usd: "Unze (USD)",
                gram_24_usd: "Gramm 24 (USD)", ounce_syp: "Unze (SYP)",
                gram_21_syp: "Gramm 21 (SYP)", silver_title: "Silber",
                gram_usd: "Gramm (USD)", disclaimer: "Preise werden von zuverl√§ssigen Quellen bezogen.",
                live_prices: "Live-Aktualisierung"
            },
            zh: {
                nav_currencies: "Ë¥ßÂ∏Å", nav_gold: "ÈªÑÈáë", nav_crypto: "Âä†ÂØÜË¥ßÂ∏Å",
                title_converter: "Ë¥ßÂ∏ÅËΩ¨Êç¢Âô®", label_amount: "ÈáëÈ¢ù",
                select_currency: "ÈÄâÊã©Ë¥ßÂ∏Å", label_from: "‰ªé", label_to: "Âà∞",
                btn_convert: "ËΩ¨Êç¢", title_metals: "ÈáëÂ±û‰ª∑Ê†º", btn_refresh: "Á´ãÂç≥Âà∑Êñ∞",
                loading: "Âä†ËΩΩ‰∏≠...", title_calc: "ÈªÑÈáë‰ª∑ÂÄºËÆ°ÁÆóÂô®",
                label_weight: "ÈáçÈáèÔºàÂÖãÔºâ", label_karat: "Á∫ØÂ∫¶", label_currency: "Ë¥ßÂ∏Å",
                btn_calc: "ËÆ°ÁÆó", label_approx: "‰º∞ÁÆóÂÄº:",
                market_prices: "ÂÖ®ÁêÉÂ∏ÇÂú∫‰ª∑Ê†º", ounce_usd: "ÁõéÂè∏ÔºàÁæéÂÖÉÔºâ",
                gram_24_usd: "ÂÖã 24ÔºàÁæéÂÖÉÔºâ", ounce_syp: "ÁõéÂè∏ÔºàÂèôÂà©‰∫öÈïëÔºâ",
                gram_21_syp: "ÂÖã 21ÔºàÂèôÂà©‰∫öÈïëÔºâ", silver_title: "ÁôΩÈì∂",
                gram_usd: "ÂÖãÔºàÁæéÂÖÉÔºâ", disclaimer: "‰ª∑Ê†ºÂèñËá™ÂèØÈù†Êù•Ê∫ê„ÄÇ",
                live_prices: "ÂÆûÊó∂‰ª∑Ê†ºÊõ¥Êñ∞"
            },
            ja: {
                nav_currencies: "ÈÄöË≤®", nav_gold: "Èáë", nav_crypto: "ÊöóÂè∑Ë≥áÁî£",
                title_converter: "ÈÄöË≤®„Ç≥„É≥„Éê„Éº„Çø„Éº", label_amount: "ÈáëÈ°ç",
                select_currency: "ÈÄöË≤®„ÇíÈÅ∏Êäû", label_from: "„Åã„Çâ", label_to: "„Å∏",
                btn_convert: "Â§âÊèõ", title_metals: "Ë≤¥ÈáëÂ±û‰æ°Ê†º", btn_refresh: "‰ªä„Åô„ÅêÊõ¥Êñ∞",
                loading: "Ë™≠„ÅøËæº„Åø‰∏≠...", title_calc: "„Ç¥„Éº„É´„Éâ‰æ°ÂÄ§Ë®àÁÆóÊ©ü",
                label_weight: "Èáç„ÅïÔºà„Ç∞„É©„É†Ôºâ", label_karat: "„Ç´„É©„ÉÉ„Éà", label_currency: "ÈÄöË≤®",
                btn_calc: "Ë®àÁÆó„Åô„Çã", label_approx: "Ê¶ÇÁÆó‰æ°ÂÄ§:",
                market_prices: "‰∏ñÁïåÂ∏ÇÂ†¥‰æ°Ê†º", ounce_usd: "„Ç™„É≥„Çπ (USD)",
                gram_24_usd: "„Ç∞„É©„É† 24 (USD)", ounce_syp: "„Ç™„É≥„Çπ (SYP)",
                gram_21_syp: "„Ç∞„É©„É† 21 (SYP)", silver_title: "„Ç∑„É´„Éê„Éº",
                gram_usd: "„Ç∞„É©„É† (USD)", disclaimer: "‰æ°Ê†º„ÅØ‰ø°È†º„Åß„Åç„Çã„ÇΩ„Éº„Çπ„Åã„ÇâÂèñÂæó„Åï„Çå„Åæ„Åô„ÄÇ",
                live_prices: "„É™„Ç¢„É´„Çø„Ç§„É†Êõ¥Êñ∞"
            },
            ru: {
                nav_currencies: "–í–∞–ª—é—Ç—ã", nav_gold: "–ó–æ–ª–æ—Ç–æ", nav_crypto: "–ö—Ä–∏–ø—Ç–æ",
                title_converter: "–ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä –≤–∞–ª—é—Ç", label_amount: "–°—É–º–º–∞",
                select_currency: "–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞–ª—é—Ç—É", label_from: "–û—Ç", label_to: "–í",
                btn_convert: "–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å", title_metals: "–¶–µ–Ω—ã –Ω–∞ –º–µ—Ç–∞–ª–ª—ã", btn_refresh: "–û–±–Ω–æ–≤–∏—Ç—å",
                loading: "–ó–∞–≥—Ä—É–∑–∫–∞...", title_calc: "–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∑–æ–ª–æ—Ç–∞",
                label_weight: "–í–µ—Å (–≥—Ä–∞–º–º—ã)", label_karat: "–ü—Ä–æ–±–∞", label_currency: "–í–∞–ª—é—Ç–∞",
                btn_calc: "–†–∞—Å—Å—á–∏—Ç–∞—Ç—å", label_approx: "–ü—Ä–∏–º–µ—Ä–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å:",
                market_prices: "–ú–∏—Ä–æ–≤—ã–µ —Ä—ã–Ω–æ—á–Ω—ã–µ —Ü–µ–Ω—ã", ounce_usd: "–£–Ω—Ü–∏—è (USD)",
                gram_24_usd: "–ì—Ä–∞–º–º 24 (USD)", ounce_syp: "–£–Ω—Ü–∏—è (SYP)",
                gram_21_syp: "–ì—Ä–∞–º–º 21 (SYP)", silver_title: "–°–µ—Ä–µ–±—Ä–æ",
                gram_usd: "–ì—Ä–∞–º–º (USD)", disclaimer: "–¶–µ–Ω—ã –±–µ—Ä—É—Ç—Å—è –∏–∑ –Ω–∞–¥–µ–∂–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤.",
                live_prices: "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏"
            },
            pt: {
                nav_currencies: "Moedas", nav_gold: "Ouro", nav_crypto: "Cripto",
                title_converter: "Conversor de Moedas", label_amount: "Quantidade",
                select_currency: "Selecione Moeda", label_from: "De", label_to: "Para",
                btn_convert: "Converter", title_metals: "Pre√ßos de Metais", btn_refresh: "Atualizar",
                loading: "Carregando...", title_calc: "Calculadora de Ouro",
                label_weight: "Peso (Gramas)", label_karat: "Quilates", label_currency: "Moeda",
                btn_calc: "Calcular", label_approx: "Valor Aprox:",
                market_prices: "Pre√ßos Globais", ounce_usd: "On√ßa (USD)",
                gram_24_usd: "Grama 24 (USD)", ounce_syp: "On√ßa (SYP)",
                gram_21_syp: "Grama 21 (SYP)", silver_title: "Prata",
                gram_usd: "Grama (USD)", disclaimer: "Os pre√ßos s√£o obtidos de fontes confi√°veis.",
                live_prices: "Atualiza√ß√£o ao vivo"
            },
            hi: {
                nav_currencies: "‡§Æ‡•Å‡§¶‡•ç‡§∞‡§æ‡§è‡§Ç", nav_gold: "‡§∏‡•ã‡§®‡§æ", nav_crypto: "‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü‡•ã",
                title_converter: "‡§Æ‡•Å‡§¶‡•ç‡§∞‡§æ ‡§™‡§∞‡§ø‡§µ‡§∞‡•ç‡§§‡§ï", label_amount: "‡§∞‡§æ‡§∂‡§ø",
                select_currency: "‡§Æ‡•Å‡§¶‡•ç‡§∞‡§æ ‡§ö‡•Å‡§®‡•á‡§Ç", label_from: "‡§∏‡•á", label_to: "‡§ï‡•á ‡§≤‡§ø‡§è",
                btn_convert: "‡§™‡§∞‡§ø‡§µ‡§∞‡•ç‡§§‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç", title_metals: "‡§ß‡§æ‡§§‡•Å‡§ì‡§Ç ‡§ï‡•Ä ‡§ï‡•Ä‡§Æ‡§§‡•á‡§Ç", btn_refresh: "‡§Ö‡§≠‡•Ä ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç",
                loading: "‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...", title_calc: "‡§∏‡•ã‡§®‡§æ ‡§Æ‡•Ç‡§≤‡•ç‡§Ø‡§æ‡§Ç‡§ï‡§®",
                label_weight: "‡§µ‡§ú‡§® (‡§ó‡•ç‡§∞‡§æ‡§Æ)", label_karat: "‡§ï‡•à‡§∞‡•á‡§ü", label_currency: "‡§Æ‡•Å‡§¶‡•ç‡§∞‡§æ",
                btn_calc: "‡§ó‡§£‡§®‡§æ ‡§ï‡§∞‡•á‡§Ç", label_approx: "‡§Ö‡§®‡•Å‡§Æ‡§æ‡§®‡§ø‡§§ ‡§Æ‡•Ç‡§≤‡•ç‡§Ø:",
                market_prices: "‡§µ‡•à‡§∂‡•ç‡§µ‡§ø‡§ï ‡§¨‡§æ‡§ú‡§æ‡§∞ ‡§ï‡•Ä‡§Æ‡§§‡•á‡§Ç", ounce_usd: "‡§î‡§Ç‡§∏ (USD)",
                gram_24_usd: "‡§ó‡•ç‡§∞‡§æ‡§Æ 24 (USD)", ounce_syp: "‡§î‡§Ç‡§∏ (SYP)",
                gram_21_syp: "‡§ó‡•ç‡§∞‡§æ‡§Æ 21 (SYP)", silver_title: "‡§ö‡§æ‡§Ç‡§¶‡•Ä",
                gram_usd: "‡§ó‡•ç‡§∞‡§æ‡§Æ (USD)", disclaimer: "‡§ï‡•Ä‡§Æ‡§§‡•á‡§Ç ‡§µ‡§ø‡§∂‡•ç‡§µ‡§∏‡§®‡•Ä‡§Ø ‡§∏‡•ç‡§∞‡•ã‡§§‡•ã‡§Ç ‡§∏‡•á ‡§≤‡•Ä ‡§ó‡§à ‡§π‡•à‡§Ç‡•§",
                live_prices: "‡§≤‡§æ‡§á‡§µ ‡§Ö‡§™‡§°‡•á‡§ü"
            },
            it: {
                nav_currencies: "Valute", nav_gold: "Oro", nav_crypto: "Cripto",
                title_converter: "Convertitore di Valuta", label_amount: "Importo",
                select_currency: "Seleziona Valuta", label_from: "Da", label_to: "A",
                btn_convert: "Converti", title_metals: "Prezzi dei Metalli", btn_refresh: "Aggiorna",
                loading: "Caricamento...", title_calc: "Calcolatore Oro",
                label_weight: "Peso (Grammi)", label_karat: "Carati", label_currency: "Valuta",
                btn_calc: "Calcola", label_approx: "Valore Approssimativo:",
                market_prices: "Prezzi di Mercato Globali", ounce_usd: "Oncia (USD)",
                gram_24_usd: "Grammo 24 (USD)", ounce_syp: "Oncia (SYP)",
                gram_21_syp: "Grammo 21 (SYP)", silver_title: "Argento",
                gram_usd: "Grammo (USD)", disclaimer: "I prezzi vengono recuperati da fonti affidabili.",
                live_prices: "Aggiornamento dal vivo"
            }
        };

        let currentLang = localStorage.getItem('appLang') || navigator.language.split('-')[0] || 'ar';
        if (!translations[currentLang]) currentLang = 'en';

        // === Language Logic ===
        function initLanguageSelector() {
            const container = document.getElementById('langOptions');
            let html = '';
            for (const [code, data] of Object.entries(supportedLanguages)) {
                html += `
                <div class="lang-option" onclick="setLanguage('${code}')">
                    <img src="https://flagcdn.com/w40/${data.flag}.png" alt="${data.flag}">
                    <span>${data.name}</span>
                </div>`;
            }
            container.innerHTML = html;

            const trigger = document.getElementById('langTrigger');
            const wrapper = document.getElementById('langWrapper');
            
            trigger.addEventListener('click', (e) => {
                e.stopPropagation();
                wrapper.classList.toggle('open');
            });
            
            window.addEventListener('click', () => {
                wrapper.classList.remove('open');
            });
        }

        function setLanguage(lang) {
            currentLang = lang;
            localStorage.setItem('appLang', lang);
            applyLanguage(currentLang);
            
            const savedFrom = selectedFrom;
            const savedTo = selectedTo;
            const savedCalc = selectedCalcCurrency;

            if(currencyList && Object.keys(currencyList).length > 0) {
                initCustomSelects(currencyList);
                initCalcCurrencySelect(currencyList);
                
                setTimeout(() => {
                    selectOption('fromSelect', savedFrom);
                    selectOption('toSelect', savedTo);
                    selectOption('calcCurrencySelect', savedCalc);
                }, 50);
            }
        }

        function applyLanguage(lang) {
            document.documentElement.lang = lang;
            document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
            
            const activeTrans = translations[lang] || translations['en'];

            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (activeTrans[key]) el.textContent = activeTrans[key];
            });
        }

        // === Theme ===
        const savedTheme = localStorage.getItem('theme') || 'dark';
        document.documentElement.setAttribute('data-theme', savedTheme);
        updateThemeIcon(savedTheme);

        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            updateThemeIcon(newTheme);
        }

        function updateThemeIcon(theme) {
            const iconSpan = document.getElementById('themeIcon');
            iconSpan.textContent = theme === 'dark' ? 'üåô' : '‚òÄÔ∏è';
        }

        // === Data & APIs ===
        const API_ENDPOINTS = [
            "https://api.exchangerate-api.com/v4/latest/", 
            "https://open.er-api.com/v6/latest/"
        ];

        let selectedFrom = 'USD';
        let selectedTo = 'EUR';
        let selectedCalcCurrency = 'SYP'; 
        let cachedRates = {}; 
        let sypRate = 0; 
        let cryptoInterval = null;
        let currentGoldPriceUsdPerGram = 0;
        let currencyList = {}; 

        const arabicNames = {
            AED: "ÿØÿ±ŸáŸÖ ÿ•ŸÖÿßÿ±ÿßÿ™Ÿä", AFN: "ÿ£ŸÅÿ∫ÿßŸÜŸä", ALL: "ŸÑŸäŸÉ ÿ£ŸÑÿ®ÿßŸÜŸä", AMD: "ÿØÿ±ÿßŸÖ ÿ£ÿ±ŸÖŸäŸÜŸä", ANG: "ÿ¨ŸäŸÑÿØÿ± ŸáŸàŸÑŸÜÿØŸä", AOA: "ŸÉŸàÿßŸÜÿ≤ÿß ÿ£ŸÜÿ∫ŸàŸÑŸä", ARS: "ÿ®Ÿäÿ≤Ÿà ÿ£ÿ±ÿ¨ŸÜÿ™ŸäŸÜŸä", AUD: "ÿØŸàŸÑÿßÿ± ÿ£ÿ≥ÿ™ÿ±ÿßŸÑŸä", AWG: "ÿ¨ŸäŸÑÿØÿ± ÿ£ÿ±Ÿàÿ®Ÿä", AZN: "ŸÖÿßŸÜÿßÿ™ ÿ£ÿ∞ÿ±ÿ®Ÿäÿ¨ÿßŸÜŸä",
            BAM: "ŸÖÿßÿ±ŸÉ ŸÇÿßÿ®ŸÑ ŸÑŸÑÿ™ÿ≠ŸàŸäŸÑ", BBD: "ÿØŸàŸÑÿßÿ± ÿ®ÿ±ÿ®ÿßÿØŸàÿ≥Ÿä", BDT: "ÿ™ÿßŸÉÿß ÿ®ŸÜÿ∫ŸÑÿßÿØŸäÿ¥Ÿä", BGN: "ŸÑŸäŸÅ ÿ®ŸÑÿ∫ÿßÿ±Ÿä", BHD: "ÿØŸäŸÜÿßÿ± ÿ®ÿ≠ÿ±ŸäŸÜŸä", BIF: "ŸÅÿ±ŸÜŸÉ ÿ®ÿ±ŸàŸÜÿØŸä", BMD: "ÿØŸàŸÑÿßÿ± ÿ®ÿ±ŸÖŸàÿØŸä", BND: "ÿØŸàŸÑÿßÿ± ÿ®ÿ±ŸàŸÜŸä", BOB: "ÿ®ŸàŸÑŸäŸÅŸäÿßŸÜŸà", BRL: "ÿ±ŸäÿßŸÑ ÿ®ÿ±ÿßÿ≤ŸäŸÑŸä", BSD: "ÿØŸàŸÑÿßÿ± ÿ®ŸáÿßŸÖŸä", BTC: "ÿ®Ÿäÿ™ŸÉŸàŸäŸÜ", BTN: "ŸÜÿ∫ŸÑÿ™ÿ±ŸàŸÖ ÿ®Ÿàÿ™ÿßŸÜŸä", BWP: "ÿ®ŸàŸÑÿß ÿ®Ÿàÿ™ÿ≥ŸàÿßŸÜŸä", BYN: "ÿ±Ÿàÿ®ŸÑ ÿ®ŸÑÿßÿ±Ÿàÿ≥Ÿä", BZD: "ÿØŸàŸÑÿßÿ± ÿ®ŸÑŸäÿ≤Ÿä",
            CAD: "ÿØŸàŸÑÿßÿ± ŸÉŸÜÿØŸä", CDF: "ŸÅÿ±ŸÜŸÉ ŸÉŸàŸÜÿ∫ŸàŸÑŸä", CHF: "ŸÅÿ±ŸÜŸÉ ÿ≥ŸàŸäÿ≥ÿ±Ÿä", CLP: "ÿ®Ÿäÿ≤Ÿà ÿ™ÿ¥ŸäŸÑŸä", CNY: "ŸäŸàÿßŸÜ ÿµŸäŸÜŸä", COP: "ÿ®Ÿäÿ≤Ÿà ŸÉŸàŸÑŸàŸÖÿ®Ÿä", CRC: "ŸÉŸàŸÑŸàŸÜ ŸÉŸàÿ≥ÿ™ÿßÿ±ŸäŸÉŸä", CUC: "ÿ®Ÿäÿ≤Ÿà ŸÉŸàÿ®Ÿä ŸÇÿßÿ®ŸÑ ŸÑŸÑÿ™ÿ≠ŸàŸäŸÑ", CUP: "ÿ®Ÿäÿ≤Ÿà ŸÉŸàÿ®Ÿä", CVE: "ÿ•ÿ≥ŸÉŸàÿØŸà ÿ±ÿ£ÿ≥ ÿ£ÿÆÿ∂ÿ±Ÿä", CZK: "ŸÉŸàÿ±ŸàŸÜÿß ÿ™ÿ¥ŸäŸÉŸäÿ©",
            DJF: "ŸÅÿ±ŸÜŸÉ ÿ¨Ÿäÿ®Ÿàÿ™Ÿä", DKK: "ŸÉÿ±ŸàŸÜÿ© ÿØÿßŸÜŸÖÿ±ŸÉŸäÿ©", DOP: "ÿ®Ÿäÿ≤Ÿà ÿØŸàŸÖŸäŸÜŸäŸÉŸä", DZD: "ÿØŸäŸÜÿßÿ± ÿ¨ÿ≤ÿßÿ¶ÿ±Ÿä",
            EGP: "ÿ¨ŸÜŸäŸá ŸÖÿµÿ±Ÿä", ERN: "ŸÜÿßŸÇŸÅÿß ÿ•ÿ±Ÿäÿ™ÿ±Ÿä", ETB: "ÿ®Ÿäÿ± ÿ•ÿ´ŸäŸàÿ®Ÿä", EUR: "ŸäŸàÿ±Ÿà",
            FJD: "ÿØŸàŸÑÿßÿ± ŸÅŸäÿ¨Ÿä", FKP: "ÿ¨ŸÜŸäŸá ÿ¨ÿ≤ÿ± ŸÅŸàŸÉŸÑÿßŸÜÿØ", GBP: "ÿ¨ŸÜŸäŸá ÿ•ÿ≥ÿ™ÿ±ŸÑŸäŸÜŸä", GEL: "ŸÑÿßÿ±Ÿä ÿ¨Ÿàÿ±ÿ¨Ÿä", GGP: "ÿ¨ŸÜŸäŸá ÿ∫ÿ±ŸÜÿ≤Ÿä", GHS: "ÿ≥ŸäÿØŸä ÿ∫ÿßŸÜŸä", GIP: "ÿ¨ŸÜŸäŸá ÿ¨ÿ®ŸÑ ÿ∑ÿßÿ±ŸÇ", GMD: "ÿØÿßŸÑÿßÿ≥Ÿä ÿ∫ÿßŸÖÿ®Ÿä", GNF: "ŸÅÿ±ŸÜŸÉ ÿ∫ŸäŸÜŸä", GTQ: "ŸÉŸäÿ™ÿ≤ÿßŸÑ ÿ∫Ÿàÿßÿ™ŸäŸÖÿßŸÑŸä", GYD: "ÿØŸàŸÑÿßÿ± ÿ∫ŸäÿßŸÜÿß",
            HKD: "ÿØŸàŸÑÿßÿ± ŸáŸàŸÜÿ∫ ŸÉŸàŸÜÿ∫Ÿä", HNL: "ŸÑŸÖÿ®Ÿäÿ±ÿß ŸáŸÜÿØŸàÿ±ÿßÿ≥Ÿäÿ©", HRK: "ŸÉŸàŸÜÿß ŸÉÿ±Ÿàÿßÿ™Ÿäÿ©", HTG: "ÿ∫Ÿàÿ±ÿØ ŸáÿßŸäÿ™Ÿä", HUF: "ŸÅŸàÿ±ŸÜÿ™ ŸÖÿ¨ÿ±Ÿä",
            IDR: "ÿ±Ÿàÿ®Ÿäÿ© ÿ•ŸÜÿØŸàŸÜŸäÿ≥Ÿäÿ©", IMP: "ÿ¨ŸÜŸäŸá ŸÖÿßŸÜ", INR: "ÿ±Ÿàÿ®Ÿäÿ© ŸáŸÜÿØŸäÿ©", IQD: "ÿØŸäŸÜÿßÿ± ÿπÿ±ÿßŸÇŸä", IRR: "ÿ±ŸäÿßŸÑ ÿ•Ÿäÿ±ÿßŸÜŸä", ISK: "ŸÉÿ±ŸàŸÜÿ© ÿ¢Ÿäÿ≥ŸÑŸÜÿØŸäÿ©", JEP: "ÿ¨ŸÜŸäŸá ÿ¨Ÿäÿ±ÿ≤Ÿä", JMD: "ÿØŸàŸÑÿßÿ± ÿ¨ÿßŸÖÿßŸäŸÉŸä", JOD: "ÿØŸäŸÜÿßÿ± ÿ£ÿ±ÿØŸÜŸä", JPY: "ŸäŸÜ Ÿäÿßÿ®ÿßŸÜŸä",
            KES: "ÿ¥ŸÑŸÜ ŸÉŸäŸÜŸä", KGS: "ÿ≥ŸàŸÖ ŸÇÿ±ÿ∫Ÿäÿ≤ÿ≥ÿ™ÿßŸÜŸä", KHR: "ÿ±ŸäŸäŸÑ ŸÉŸÖÿ®ŸàÿØŸä", KMF: "ŸÅÿ±ŸÜŸÉ ŸÇŸÖÿ±Ÿä", KPW: "ŸàŸàŸÜ ŸÉŸàÿ±Ÿä ÿ¥ŸÖÿßŸÑŸä", KRW: "ŸàŸàŸÜ ŸÉŸàÿ±Ÿä ÿ¨ŸÜŸàÿ®Ÿä", KWD: "ÿØŸäŸÜÿßÿ± ŸÉŸàŸäÿ™Ÿä", KYD: "ÿØŸàŸÑÿßÿ± ÿ¨ÿ≤ÿ± ŸÉÿßŸäŸÖÿßŸÜ", KZT: "ÿ™ŸäŸÜÿ∫ ŸÉÿßÿ≤ÿßÿÆÿ≥ÿ™ÿßŸÜŸä",
            LAK: "ŸÉŸäÿ® ŸÑÿßŸàÿ≥Ÿä", LBP: "ŸÑŸäÿ±ÿ© ŸÑÿ®ŸÜÿßŸÜŸäÿ©", LKR: "ÿ±Ÿàÿ®Ÿäÿ© ÿ≥ÿ±ŸäŸÑÿßŸÜŸÉŸäÿ©", LRD: "ÿØŸàŸÑÿßÿ± ŸÑŸäÿ®Ÿäÿ±Ÿä", LSL: "ŸÑŸàÿ™Ÿä ŸÑŸäÿ≥Ÿàÿ™Ÿà", LYD: "ÿØŸäŸÜÿßÿ± ŸÑŸäÿ®Ÿä",
            MAD: "ÿØÿ±ŸáŸÖ ŸÖÿ∫ÿ±ÿ®Ÿä", MDL: "ŸÑŸäŸà ŸÖŸàŸÑÿØŸàŸÅŸä", MGA: "ÿ£ÿ±Ÿäÿßÿ±Ÿä ŸÖÿØÿ∫ÿ¥ŸÇÿ±Ÿä", MKD: "ÿØŸäŸÜÿßÿ± ŸÖŸÇÿØŸàŸÜŸä", MMK: "ŸÉŸäÿßÿ™ ŸÖŸäÿßŸÜŸÖÿßÿ±Ÿä", MNT: "ÿ™Ÿàÿ∫ÿ±ŸäŸÉ ŸÖŸÜÿ∫ŸàŸÑŸä", MOP: "ÿ®ÿßÿ™ÿßŸÉÿß ŸÖÿßŸÉÿßŸàŸä", MRU: "ÿ£ŸàŸÇŸäÿ© ŸÖŸàÿ±Ÿäÿ™ÿßŸÜŸäÿ©", MUR: "ÿ±Ÿàÿ®Ÿäÿ© ŸÖŸàÿ±Ÿäÿ¥ŸäŸàÿ≥Ÿäÿ©", MVR: "ÿ±ŸàŸÅŸäŸäÿ© ŸÖÿßŸÑÿØŸäŸÅŸäÿ©", MWK: "ŸÉŸàÿßÿ¥ÿß ŸÖŸÑÿßŸàŸä", MXN: "ÿ®Ÿäÿ≤Ÿà ŸÖŸÉÿ≥ŸäŸÉŸä", MYR: "ÿ±ŸäŸÜÿ∫Ÿäÿ™ ŸÖÿßŸÑŸäÿ≤Ÿä", MZN: "ŸÖŸäÿ™ŸÉÿßŸÑ ŸÖŸàÿ≤ŸÖÿ®ŸäŸÇŸä",
            NAD: "ÿØŸàŸÑÿßÿ± ŸÜÿßŸÖŸäÿ®Ÿä", NGN: "ŸÜÿßŸäÿ±ÿß ŸÜŸäÿ¨Ÿäÿ±Ÿä", NIO: "ŸÉŸàÿ±ÿØŸàÿ®ÿß ŸÜŸäŸÉÿßÿ±ÿßÿ∫Ÿàÿß", NOK: "ŸÉÿ±ŸàŸÜÿ© ŸÜÿ±ŸàŸäÿ¨Ÿäÿ©", NPR: "ÿ±Ÿàÿ®Ÿäÿ© ŸÜŸäÿ®ÿßŸÑŸäÿ©", NZD: "ÿØŸàŸÑÿßÿ± ŸÜŸäŸàÿ≤ŸäŸÑŸÜÿØŸä",
            OMR: "ÿ±ŸäÿßŸÑ ÿπŸÖÿßŸÜŸä",
            PAB: "ÿ®ÿßŸÑÿ®Ÿàÿß ÿ®ŸÜŸÖŸä", PEN: "ÿ≥ŸàŸÑ ÿ®Ÿäÿ±ŸàŸÅŸä", PGK: "ŸÉŸäŸÜÿß ÿ®ÿßÿ®Ÿàÿß ÿ∫ŸäŸÜŸäÿß ÿ¨ÿØŸäÿØÿ©", PHP: "ÿ®Ÿäÿ≤Ÿà ŸÅŸÑÿ®ŸäŸÜŸä", PKR: "ÿ±Ÿàÿ®Ÿäÿ© ÿ®ÿßŸÉÿ≥ÿ™ÿßŸÜŸäÿ©", PLN: "ÿ≤ŸÑŸàÿ™Ÿä ÿ®ŸàŸÑŸÜÿØŸä", PYG: "ÿ∫Ÿàÿßÿ±ÿßŸÜŸä ÿ®ÿßÿ±ÿßÿ∫ŸàÿßŸä",
            QAR: "ÿ±ŸäÿßŸÑ ŸÇÿ∑ÿ±Ÿä",
            RON: "ŸÑŸäŸà ÿ±ŸàŸÖÿßŸÜŸä", RSD: "ÿØŸäŸÜÿßÿ± ÿµÿ±ÿ®Ÿä", RUB: "ÿ±Ÿàÿ®ŸÑ ÿ±Ÿàÿ≥Ÿä", RWF: "ŸÅÿ±ŸÜŸÉ ÿ±ŸàÿßŸÜÿØŸä",
            SAR: "ÿ±ŸäÿßŸÑ ÿ≥ÿπŸàÿØŸä", SBD: "ÿØŸàŸÑÿßÿ± ÿ¨ÿ≤ÿ± ÿ≥ŸÑŸäŸÖÿßŸÜ", SCR: "ÿ±Ÿàÿ®Ÿäÿ© ÿ≥Ÿäÿ¥ŸÑŸäÿ©", SDG: "ÿ¨ŸÜŸäŸá ÿ≥ŸàÿØÿßŸÜŸä", SEK: "ŸÉÿ±ŸàŸÜÿ© ÿ≥ŸàŸäÿØŸäÿ©", SGD: "ÿØŸàŸÑÿßÿ± ÿ≥ŸÜÿ∫ÿßŸÅŸàÿ±Ÿä", SHP: "ÿ¨ŸÜŸäŸá ÿ≥ÿßŸÜÿ™ ŸáŸäŸÑŸäŸÜ", SLL: "ŸÑŸäŸàŸÜ ÿ≥Ÿäÿ±ÿßŸÑŸäŸàŸÜ", SOS: "ÿ¥ŸÑŸÜ ÿµŸàŸÖÿßŸÑŸä", SPL: "ŸÑŸàÿ®Ÿäÿ∫Ÿà", SRD: "ÿØŸàŸÑÿßÿ± ÿ≥Ÿàÿ±ŸäŸÜÿßŸÖŸä", STN: "ÿØŸàÿ®ÿ±ÿß ÿ≥ÿßŸà ÿ™ŸàŸÖŸä", SVC: "ŸÉŸàŸÑŸàŸÜ ÿ≥ŸÑŸÅÿßÿØŸàÿ±Ÿä", SYP: "ŸÑŸäÿ±ÿ© ÿ≥Ÿàÿ±Ÿäÿ©", SZL: "ŸÑŸäŸÑÿßŸÜÿ¨ŸäŸÜŸä ÿ≥Ÿàÿßÿ≤Ÿä",
            THB: "ÿ®ÿßÿ™ ÿ™ÿßŸäŸÑÿßŸÜÿØŸä", TJS: "ÿ≥ŸàŸÖŸàŸÜŸä ÿ∑ÿßÿ¨ŸäŸÉŸä", TMT: "ŸÖŸÜÿßÿ™ ÿ™ÿ±ŸÉŸÖÿßŸÜÿ≥ÿ™ÿßŸÜŸä", TND: "ÿØŸäŸÜÿßÿ± ÿ™ŸàŸÜÿ≥Ÿä", TOP: "ÿ®ÿßŸÜÿ∫ÿß ÿ™ŸàŸÜÿ∫Ÿä", TRY: "ŸÑŸäÿ±ÿ© ÿ™ÿ±ŸÉŸäÿ©", TTD: "ÿØŸàŸÑÿßÿ± ÿ™ÿ±ŸäŸÜŸäÿØÿßÿØŸä", TVD: "ÿØŸàŸÑÿßÿ± ÿ™ŸàŸÅÿßŸÑŸà", TWD: "ÿØŸàŸÑÿßÿ± ÿ™ÿßŸäŸàÿßŸÜŸä ÿ¨ÿØŸäÿØ", TZS: "ÿ¥ŸÑŸÜ ÿ™ŸÜÿ≤ÿßŸÜŸä",
            UAH: "Ÿáÿ±ŸäŸÅŸÜŸäÿß ÿ£ŸàŸÉÿ±ÿßŸÜŸäÿ©", UGX: "ÿ¥ŸÑŸÜ ÿ£Ÿàÿ∫ŸÜÿØŸä", USD: "ÿØŸàŸÑÿßÿ± ÿ£ŸÖÿ±ŸäŸÉŸä", UYU: "ÿ®Ÿäÿ≤Ÿà ÿ£Ÿàÿ±Ÿàÿ∫ŸàÿßŸä", UZS: "ÿ≥ŸàŸÖ ÿ£Ÿàÿ≤ÿ®ŸÉÿ≥ÿ™ÿßŸÜŸä",
            VEF: "ÿ®ŸàŸÑŸäŸÅÿßÿ± ŸÅŸÜÿ≤ŸàŸäŸÑŸä", VND: "ÿØŸàŸÜÿ¨ ŸÅŸäÿ™ŸÜÿßŸÖŸä", VUV: "ŸÅÿßÿ™Ÿà ŸÅÿßŸÜŸàÿßÿ™Ÿà",
            WST: "ÿ™ÿßŸÑÿß ÿ≥ÿßŸÖŸàÿß",
            XAF: "ŸÅÿ±ŸÜŸÉ CFA Ÿàÿ≥ÿ∑ ÿ£ŸÅÿ±ŸäŸÇŸäÿß", XAG: "ÿ£ŸàŸÜÿµÿ© ŸÅÿ∂ÿ©", XAU: "ÿ£ŸàŸÜÿµÿ© ÿ∞Ÿáÿ®", XBA: "Ÿàÿ≠ÿØÿ© ŸÖÿ±ŸÉÿ®ÿ© ÿ£Ÿàÿ±Ÿàÿ®Ÿäÿ©", XBB: "Ÿàÿ≠ÿØÿ© ŸÖÿßŸÑŸäÿ© ÿ£Ÿàÿ±Ÿàÿ®Ÿäÿ©", XBC: "Ÿàÿ≠ÿØÿ© ÿ≠ÿ≥ÿßÿ®Ÿäÿ© ÿ£Ÿàÿ±Ÿàÿ®Ÿäÿ© (XBC)", XBD: "Ÿàÿ≠ÿØÿ© ÿ≠ÿ≥ÿßÿ®Ÿäÿ© ÿ£Ÿàÿ±Ÿàÿ®Ÿäÿ© (XBD)", XCD: "ÿØŸàŸÑÿßÿ± ÿ¥ÿ±ŸÇ ÿßŸÑŸÉÿßÿ±Ÿäÿ®Ÿä", XDR: "ÿ≠ŸÇŸàŸÇ ÿßŸÑÿ≥ÿ≠ÿ® ÿßŸÑÿÆÿßÿµÿ©", XOF: "ŸÅÿ±ŸÜŸÉ CFA ÿ∫ÿ±ÿ® ÿ£ŸÅÿ±ŸäŸÇŸäÿß", XPD: "ÿ£ŸàŸÜÿµÿ© ÿ®ÿßŸÑÿßÿØŸäŸàŸÖ", XPF: "ŸÅÿ±ŸÜŸÉ ÿ≥Ÿä ÿ•ŸÅ ÿ®Ÿä", XPT: "ÿ£ŸàŸÜÿµÿ© ÿ®ŸÑÿßÿ™ŸäŸÜ", XSU: "ÿ≥ŸàŸÉÿ±", XTS: "ÿ±ŸÖÿ≤ ÿπŸÖŸÑÿ© ŸÑŸÑÿßÿÆÿ™ÿ®ÿßÿ±", XUA: "Ÿàÿ≠ÿØÿ© ÿ≠ÿ≥ÿßÿ®Ÿäÿ© ÿ£ÿØŸäÿ≥ ÿ£ÿ®ÿßÿ®ÿß", XXX: "ÿπŸÖŸÑÿ© ÿ∫Ÿäÿ± ŸÖÿπÿ±ŸàŸÅÿ©",
            YER: "ÿ±ŸäÿßŸÑ ŸäŸÖŸÜŸä",
            ZAR: "ÿ±ÿßŸÜÿØ ÿ¨ŸÜŸàÿ® ÿ£ŸÅÿ±ŸäŸÇŸä", ZMW: "ŸÉŸàÿßÿ¥ÿß ÿ≤ÿßŸÖÿ®Ÿä", ZWL: "ÿØŸàŸÑÿßÿ± ÿ≤ŸäŸÖÿ®ÿßÿ®ŸàŸä"
        };

        const amountInput = document.getElementById('amount');
        const convertBtn = document.getElementById('convertBtn');
        const swapBtn = document.getElementById('swapBtn');
        const loader = document.getElementById('loader');
        const btnText = document.querySelector('#convertBtn .btn-text');
        const resultBox = document.getElementById('resultBox');
        const resultAmount = document.getElementById('resultAmount');
        const rateDisplay = document.getElementById('rateDisplay');
        const toast = document.getElementById('toast');

        async function fetchRatesWithFallback(baseCurrency) {
            for (const apiUrl of API_ENDPOINTS) {
                try {
                    const response = await fetch(`${apiUrl}${baseCurrency}`, { cache: 'no-store' });
                    if (!response.ok) throw new Error("Network response was not ok");
                    const data = await response.json();
                    if (data.rates) return data.rates;
                } catch (error) {
                    continue;
                }
            }
            return null;
        }

        function switchView(viewName, btnElement) {
            if (viewName !== 'crypto' && cryptoInterval) {
                clearInterval(cryptoInterval);
                cryptoInterval = null;
                document.getElementById('crypto-live-indicator').style.display = 'none';
            }

            document.querySelectorAll('.view-section').forEach(el => el.classList.remove('active-view'));
            document.querySelectorAll('.nav-btn').forEach(el => el.classList.remove('active'));

            document.getElementById(`view-${viewName}`).classList.add('active-view');
            
            if(btnElement) btnElement.classList.add('active');
            else {
                const index = ['home', 'gold', 'crypto'].indexOf(viewName);
                if(index >= 0) document.querySelectorAll('.nav-btn')[index].classList.add('active');
            }

            if(viewName === 'gold') fetchGoldAndSilver();
            if(viewName === 'crypto') initCrypto();
        }

        document.addEventListener('DOMContentLoaded', async () => {
            initLanguageSelector(); 
            applyLanguage(currentLang); 
            await initCurrencies();
            
            convertBtn.addEventListener('click', performConvert);
            amountInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') performConvert();
            });
            swapBtn.addEventListener('click', () => {
                swapBtn.style.transform = "rotate(180deg) scale(1.1)";
                setTimeout(() => swapBtn.style.transform = "rotate(0deg) scale(1)", 300);
                const temp = selectedFrom;
                selectOption('fromSelect', selectedTo);
                selectOption('toSelect', temp);
                performConvert();
            });
        });

        async function initCurrencies() {
            try {
                const rates = await fetchRatesWithFallback('USD');
                if (rates) {
                    Object.keys(rates).forEach(code => currencyList[code] = code);
                    cachedRates = rates;
                    sypRate = rates['SYP'];
                    initCustomSelects(currencyList);
                    initCalcCurrencySelect(currencyList);
                } else throw new Error("All APIs failed");
            } catch (e) {
                showToast(translations[currentLang]?.loading || "Error");
            }
        }

        function getIconUrl(code) {
            if (['XAU','XAG','BTC','ETH','XDR','XAF','XOF','XCD','XPF'].includes(code)) return 'https://cdn-icons-png.flaticon.com/512/3135/3135715.png';
            if (code === 'ANG') return 'https://flagcdn.com/w40/nl.png';
            return `https://flagcdn.com/w40/${code.substring(0, 2).toLowerCase()}.png`;
        }

        function createListHTML() {
            let closeBtn = `<div class="close-modal">‚úï ${currentLang==='ar'?'ÿ•ÿ∫ŸÑÿßŸÇ':'Close'}</div>`;
            let searchHTML = `<div class="currency-search-container"><input type="text" class="currency-search" placeholder="${currentLang === 'ar' ? 'ÿ®ÿ≠ÿ´...' : 'Search...'}"></div>`;
            
            const codes = Object.keys(currencyList).filter(code => code !== 'ILS').sort();
            let list = codes.map(code => {
                const iconUrl = getIconUrl(code);
                const araName = arabicNames[code] || code;
                
                let htmlName = `<strong>${code}</strong>`;
                let htmlSub = ``;

                if(currentLang === 'ar') {
                    htmlName = `<strong>${code}</strong> <span class="ar-name">${araName}</span>`;
                } else {
                    htmlName = `<strong>${code}</strong>`;
                    htmlSub = `<span class="en-name">${araName}</span>`;
                }

                return `<span class="custom-option" data-value="${code}">
                        <img src="${iconUrl}" class="flag-icon">
                        <div class="currency-text">${htmlName} ${htmlSub}</div>
                    </span>`;
            }).join('');
            return closeBtn + searchHTML + list;
        }

        function initCustomSelects() {
            const listHTML = createListHTML();
            setupCustomSelect('fromSelect', listHTML, (val) => { selectedFrom = val; });
            setupCustomSelect('toSelect', listHTML, (val) => { selectedTo = val; });
            selectOption('fromSelect', 'USD');
            selectOption('toSelect', 'EUR'); 
        }

        function initCalcCurrencySelect() {
            const listHTML = createListHTML();
            setupCustomSelect('calcCurrencySelect', listHTML, (val) => { selectedCalcCurrency = val; });
            setTimeout(() => selectOption('calcCurrencySelect', 'SYP'), 100);
        }

        function setupCustomSelect(elementId, htmlContent, callback) {
            const wrapper = document.getElementById(elementId);
            if(!wrapper) return;
            
            const trigger = wrapper.querySelector('.custom-select__trigger span:first-child');
            const optionsContainer = wrapper.querySelector('.custom-options');
            optionsContainer.innerHTML = htmlContent;

            const closeModal = () => {
                wrapper.classList.remove('open');
                wrapper.parentElement.style.zIndex = 1;
            };

            const openModal = () => {
                wrapper.classList.add('open');
                wrapper.parentElement.style.zIndex = 1000;
                const searchInput = optionsContainer.querySelector('.currency-search');
                if(searchInput) {
                    searchInput.value = '';
                    optionsContainer.querySelectorAll('.custom-option').forEach(opt => opt.style.display = 'flex');
                    searchInput.focus();
                }
            };

            wrapper.querySelector('.custom-select__trigger').addEventListener('click', function(e) {
                e.stopPropagation();
                document.querySelectorAll('.custom-select').forEach(el => {
                    if (el !== wrapper) {
                        el.classList.remove('open');
                        el.parentElement.style.zIndex = 1;
                    }
                });
                if (wrapper.classList.contains('open')) closeModal();
                else openModal();
            });

            wrapper.querySelector('.close-modal')?.addEventListener('click', closeModal);
            const searchInput = optionsContainer.querySelector('.currency-search');
            if(searchInput) {
                searchInput.addEventListener('input', (e) => {
                    const term = e.target.value.toLowerCase();
                    optionsContainer.querySelectorAll('.custom-option').forEach(opt => {
                        const code = opt.dataset.value.toLowerCase();
                        const textContent = opt.textContent.toLowerCase();
                        opt.style.display = (code.includes(term) || textContent.includes(term)) ? 'flex' : 'none';
                    });
                });
            }

            wrapper.querySelectorAll('.custom-option').forEach(option => {
                option.addEventListener('click', function() {
                    const value = this.getAttribute('data-value');
                    const araName = arabicNames[value] || value;
                    const imgSrc = this.querySelector('img').src;

                    let htmlContent = '';
                    if (currentLang === 'ar') {
                        htmlContent = `<div style="display:flex; align-items:center;"><img src="${imgSrc}" class="flag-icon" style="width:18px; height:13px; margin-left:8px;">${value} - ${araName}</div>`;
                    } else {
                        htmlContent = `<div style="display:flex; align-items:center;"><img src="${imgSrc}" class="flag-icon" style="width:18px; height:13px; margin-left:0; margin-right:8px;">${value}</div>`;
                    }
                    trigger.innerHTML = htmlContent;
                    callback(value);
                    closeModal();
                });
            });
        }

        function selectOption(elementId, code) {
            const wrapper = document.getElementById(elementId);
            if(!wrapper) return;
            const option = wrapper.querySelector(`.custom-option[data-value="${code}"]`);
            if (option) option.click();
        }

        window.addEventListener('click', function(e) {
            if (!e.target.closest('.custom-select')) {
                document.querySelectorAll('.custom-select').forEach(el => {
                    el.classList.remove('open');
                    el.parentElement.style.zIndex = 1;
                });
            }
        });

        async function performConvert() {
            const amount = parseFloat(amountInput.value);
            if (isNaN(amount) || amount <= 0) {
                showToast(currentLang === 'ar' ? "ÿßŸÑÿ±ÿ¨ÿßÿ° ÿ•ÿØÿÆÿßŸÑ ŸÖÿ®ŸÑÿ∫ ÿµÿ≠Ÿäÿ≠" : "Please enter a valid amount");
                return;
            }
            resultBox.classList.remove('show');
            setLoading(true);
            try {
                const rates = await fetchRatesWithFallback(selectedFrom);
                if (rates && rates[selectedTo]) {
                    const rate = rates[selectedTo];
                    const total = amount * rate;
                    setTimeout(() => {
                        animateResult(total, rate);
                        resultBox.classList.add('show');
                    }, 200);
                } else {
                    showToast(currentLang === 'ar' ? "ÿßŸÑÿπŸÖŸÑÿ© ÿ∫Ÿäÿ± ŸÖÿØÿπŸàŸÖÿ©" : "Currency not supported");
                }
            } catch (error) {
                showToast(currentLang === 'ar' ? "ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑÿßÿ™ÿµÿßŸÑ" : "Connection Error");
            } finally {
                setLoading(false);
            }
        }

        function animateResult(targetValue, rate) {
            rateDisplay.textContent = `1 ${selectedFrom} = ${rate.toFixed(4)} ${selectedTo}`;
            const duration = 1500;
            const startValue = 0;
            const startTime = performance.now();

            function update(currentTime) {
                const elapsed = currentTime - startTime;
                const progress = Math.min(elapsed / duration, 1);
                const ease = 1 - Math.pow(1 - progress, 3);
                const currentVal = startValue + (targetValue - startValue) * ease;
                const formatted = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(currentVal);
                resultAmount.textContent = formatted;
                if (progress < 1) requestAnimationFrame(update);
            }
            requestAnimationFrame(update);
        }

        function setLoading(isLoading) {
            convertBtn.disabled = isLoading;
            btnText.style.display = isLoading ? 'none' : 'block';
            loader.style.display = isLoading ? 'block' : 'none';
        }

        function showToast(msg) {
            toast.textContent = msg;
            toast.classList.add('active');
            setTimeout(() => toast.classList.remove('active'), 3000);
        }

        // === Gold Logic ===
        function calculateGoldValue() {
            const weight = parseFloat(document.getElementById('calc-weight').value);
            const karat = parseInt(document.getElementById('calc-karat').value);
            if (!weight || weight <= 0) {
                showToast(currentLang === 'ar' ? "ÿßŸÑÿ±ÿ¨ÿßÿ° ÿ•ÿØÿÆÿßŸÑ ÿßŸÑŸàÿ≤ŸÜ" : "Please enter weight");
                return;
            }
            if (currentGoldPriceUsdPerGram === 0) {
                showToast(currentLang === 'ar' ? "ÿ¨ÿßÿ±Ÿä ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ£ÿ≥ÿπÿßÿ±..." : "Updating prices...");
                fetchGoldAndSilver();
                return;
            }
            const priceKaratUsd = (currentGoldPriceUsdPerGram * (karat / 24));
            let exchangeRate = selectedCalcCurrency === 'USD' ? 1 : (cachedRates[selectedCalcCurrency] || 1);
            const totalValue = weight * priceKaratUsd * exchangeRate;

            const resultBox = document.getElementById('calc-result-box');
            const resultAmount = document.getElementById('calc-result-amount');
            const currencyLabel = document.getElementById('calc-currency-label');

            let formattedValue = (['SYP','LBP','IQD'].includes(selectedCalcCurrency)) 
                ? new Intl.NumberFormat('en-US', { maximumFractionDigits: 0 }).format(totalValue)
                : new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(totalValue);

            resultAmount.textContent = formattedValue;
            currencyLabel.textContent = selectedCalcCurrency;
            resultBox.classList.add('show');
        }

        async function fetchGoldAndSilver() {
            const loaderContainer = document.getElementById('gold-loader-container');
            const content = document.getElementById('gold-content');
            loaderContainer.style.display = 'flex';
            content.style.display = 'none';
            let goldUsdPerOunce = null;
            let silverUsdPerOunce = null;

            try {
                const rates = await fetchRatesWithFallback('USD');
                if (rates) {
                    if(rates['SYP']) { sypRate = rates['SYP']; cachedRates = rates; }
                    goldUsdPerOunce = rates['XAU'];
                    silverUsdPerOunce = rates['XAG'];
                }
                if (!goldUsdPerOunce) {
                    try {
                        const paxgRes = await fetch('https://api.binance.com/api/v3/ticker/price?symbol=PAXGUSDT');
                        const paxgData = await paxgRes.json();
                        goldUsdPerOunce = parseFloat(paxgData.price);
                    } catch (e) {}
                }
                if (goldUsdPerOunce) {
                    currentGoldPriceUsdPerGram = goldUsdPerOunce / 31.1035;
                    document.getElementById('gold-ounce-usd').textContent = `$${goldUsdPerOunce.toLocaleString(undefined, {minimumFractionDigits:2})}`;
                    document.getElementById('gold-gram-usd').textContent = `$${(goldUsdPerOunce / 31.1035).toFixed(2)}`;
                    document.getElementById('gold-ounce-syp').textContent = sypRate ? (goldUsdPerOunce * sypRate).toLocaleString('en-US', {maximumFractionDigits:0}) : '---';
                    document.getElementById('gold-21-syp').textContent = sypRate ? ((goldUsdPerOunce * sypRate / 31.1035) * (21/24)).toLocaleString('en-US', {maximumFractionDigits:0}) : '---';
                    
                    if (silverUsdPerOunce) {
                        document.getElementById('silver-ounce-usd').textContent = `$${silverUsdPerOunce.toFixed(2)}`;
                        document.getElementById('silver-gram-usd').textContent = `$${(silverUsdPerOunce / 31.1035).toFixed(3)}`;
                        document.querySelector('.metal-card.silver').style.display = 'block';
                    } else document.querySelector('.metal-card.silver').style.display = 'none';
                    
                    loaderContainer.style.display = 'none';
                    content.style.display = 'block';
                } else throw new Error("Gold failed");
            } catch (error) {
                loaderContainer.style.display = 'none';
                content.style.display = 'block';
                showToast(currentLang === 'ar' ? "ŸÅÿ¥ŸÑ ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ£ÿ≥ÿπÿßÿ±" : "Price update failed");
            }
        }

        // === Crypto Logic ===
        async function fetchCryptoDataArray() {
            const response = await fetch('https://api.binance.com/api/v3/ticker/price', { cache: 'no-store' });
            if(!response.ok) throw new Error("API Error");
            const data = await response.json();
            const targetSymbols = ['BTCUSDT', 'ETHUSDT', 'BNBUSDT', 'SOLUSDT', 'XRPUSDT', 'DOGEUSDT', 'ADAUSDT', 'TRXUSDT', 'TONUSDT', 'PEPEUSDT'];
            return data.filter(item => targetSymbols.includes(item.symbol));
        }

        function buildCryptoHTML(coinsData) {
            const container = document.getElementById('cryptoListContainer');
            const cryptoNames = {
                'BTC': {ar:'ÿ®Ÿäÿ™ŸÉŸàŸäŸÜ', en:'Bitcoin', es:'Bitcoin', fr:'Bitcoin', de:'Bitcoin', zh:'ÊØîÁâπÂ∏Å', ja:'„Éì„ÉÉ„Éà„Ç≥„Ç§„É≥', ru:'–ë–∏—Ç–∫–æ–∏–Ω', pt:'Bitcoin', hi:'‡§¨‡§ø‡§ü‡§ï‡•â‡§á‡§®', it:'Bitcoin'}, 
                'ETH': {ar:'ÿ•Ÿäÿ´Ÿäÿ±ŸäŸàŸÖ', en:'Ethereum', es:'Ethereum', fr:'Ethereum', de:'Ethereum', zh:'‰ª•Â§™Âùä', ja:'„Ç§„Éº„Çµ„É™„Ç¢„É†', ru:'–≠—Ñ–∏—Ä', pt:'Ethereum', hi:'‡§è‡§•‡•á‡§∞‡§ø‡§Ø‡§Æ', it:'Ethereum'}, 
                'BNB': {ar:'ÿ®ŸäŸÜÿßŸÜÿ≥', en:'Binance', es:'Binance', fr:'Binance', de:'Binance', zh:'Â∏ÅÂÆâ', ja:'„Éê„Ç§„Éä„É≥„Çπ', ru:'Binance', pt:'Binance', hi:'Binance', it:'Binance'},
                'SOL': {ar:'ÿ≥ŸàŸÑÿßŸÜÿß', en:'Solana', es:'Solana', fr:'Solana', de:'Solana', zh:'Á¥¢ÊãâÁ∫≥', ja:'„ÇΩ„É©„Éä', ru:'Solana', pt:'Solana', hi:'‡§∏‡•ã‡§≤‡§æ‡§®‡§æ', it:'Solana'}, 
                'XRP': {ar:'ÿ±Ÿäÿ®ŸÑ', en:'Ripple', es:'Ripple', fr:'Ripple', de:'Ripple', zh:'ÁëûÊ≥¢Â∏Å', ja:'„É™„ÉÉ„Éó„É´', ru:'Ripple', pt:'Ripple', hi:'‡§∞‡§ø‡§™‡§≤', it:'Ripple'}, 
                'DOGE': {ar:'ÿØŸàÿ¨ ŸÉŸàŸäŸÜ', en:'Dogecoin', es:'Dogecoin', fr:'Dogecoin', de:'Dogecoin', zh:'ÁãóÁãóÂ∏Å', ja:'„Éâ„Éº„Ç∏„Ç≥„Ç§„É≥', ru:'Dogecoin', pt:'Dogecoin', hi:'‡§°‡•â‡§ó‡§ï‡•â‡§á‡§®', it:'Dogecoin'},
                'ADA': {ar:'ŸÉÿßÿ±ÿØÿßŸÜŸà', en:'Cardano', es:'Cardano', fr:'Cardano', de:'Cardano', zh:'ËâæËææÂ∏Å', ja:'„Ç´„É´„ÉÄ„Éé', ru:'–ö–∞—Ä–¥–∞–Ω–æ', pt:'Cardano', hi:'‡§ï‡§æ‡§∞‡•ç‡§°‡§æ‡§®‡•ã', it:'Cardano'}, 
                'TRX': {ar:'ÿ™ÿ±ŸàŸÜ', en:'Tron', es:'Tron', fr:'Tron', de:'Tron', zh:'Ê≥¢Âú∫', ja:'„Éà„É≠„É≥', ru:'–¢—Ä–æ–Ω', pt:'Tron', hi:'‡§ü‡•ç‡§∞‡•â‡§®', it:'Tron'}, 
                'TON': {ar:'ÿ™ŸàŸÜ', en:'Toncoin', es:'Toncoin', fr:'Toncoin', de:'Toncoin', zh:'Toncoin', ja:'„Éà„É≥„Ç≥„Ç§„É≥', ru:'Toncoin', pt:'Toncoin', hi:'‡§ü‡§®‡§ï‡•â‡§á‡§®', it:'Toncoin'}, 
                'PEPE': {ar:'ÿ®Ÿäÿ®Ÿä', en:'Pepe', es:'Pepe', fr:'Pepe', de:'Pepe', zh:'Pepe', ja:'Pepe', ru:'Pepe', pt:'Pepe', hi:'Pepe', it:'Pepe'}
            };
            let html = '';
            coinsData.forEach(coin => {
                const symbol = coin.symbol.replace('USDT', '');
                const nameObj = cryptoNames[symbol] || {ar: symbol, en: symbol};
                const name = nameObj[currentLang] || nameObj['en'];
                const price = parseFloat(coin.price);
                const iconUrl = `https://assets.coincap.io/assets/icons/${symbol.toLowerCase()}@2x.png`;
                let formattedPrice = price < 1 ? price.toFixed(6) : price.toLocaleString('en-US', {minimumFractionDigits:2, maximumFractionDigits:2});
                html += `<div class="crypto-item"><div class="crypto-info"><img src="${iconUrl}" class="crypto-icon" onerror="this.src='https://cdn-icons-png.flaticon.com/512/6146/6146332.png'"><div><div class="crypto-name">${name}</div><div class="crypto-symbol">${symbol}/USDT</div></div></div><div class="crypto-price" id="crypto-price-${symbol}">$${formattedPrice}</div></div>`;
            });
            container.innerHTML = html;
        }

        async function updateCryptoPrices() {
            try {
                const coinsData = await fetchCryptoDataArray();
                coinsData.forEach(coin => {
                    const symbol = coin.symbol.replace('USDT', '');
                    const price = parseFloat(coin.price);
                    const priceEl = document.getElementById(`crypto-price-${symbol}`);
                    if (priceEl) {
                        let formattedPrice = price < 1 ? price.toFixed(6) : price.toLocaleString('en-US', {minimumFractionDigits:2, maximumFractionDigits:2});
                        priceEl.textContent = `$${formattedPrice}`;
                    }
                });
            } catch (error) {}
        }

        async function initCrypto() {
            const container = document.getElementById('cryptoListContainer');
            const loaderContainer = document.getElementById('crypto-loader-container');
            const liveIndicator = document.getElementById('crypto-live-indicator');
            if(cryptoInterval) clearInterval(cryptoInterval);
            const isAlreadyBuilt = document.getElementById('crypto-price-BTC') !== null;

            if (!isAlreadyBuilt) {
                loaderContainer.style.display = 'flex';
                container.innerHTML = '';
                try {
                    const data = await fetchCryptoDataArray();
                    buildCryptoHTML(data);
                    loaderContainer.style.display = 'none';
                    liveIndicator.style.display = 'flex';
                } catch (e) {
                    loaderContainer.style.display = 'none';
                    container.innerHTML = '<div style="text-align:center; padding:20px; color:var(--accent)">Connection Failed</div>';
                    return;
                }
            } else {
                liveIndicator.style.display = 'flex';
            }
            cryptoInterval = setInterval(updateCryptoPrices, 100);
        }

    </script>
</body>
</html>
