<!DOCTYPE html>
<html lang="ar" dir="rtl" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mintly Syria - Ø£Ø³ÙˆØ§Ù‚ Ø§Ù„Ù…Ø§Ù„</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@200;300;400;600;700;900&display=swap" rel="stylesheet">

    <style>
        /* === Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø£Ù„ÙˆØ§Ù† === */
        :root {
            /* Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„ÙØ§ØªØ­ (Light Mode) */
            --bg-body: #f0f2f5;
            --bg-card: #ffffff;
            --bg-header: #ffffff;
            --bg-input: #f4f6f8;
            --text-main: #2c3e50;
            --text-input: #2c3e50;
            --text-muted: #7f8c8d;
            --border: #e0e0e0;
            --accent: #d4a017; 
            --accent-hover: #b8940f;
            --accent-glow: rgba(212, 160, 23, 0.2);
            --result-color: #d4a017;
            --radius: 18px;
            --font-numbers: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            --header-height: 80px;
            --shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        /* Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¯Ø§ÙƒÙ† (Dark Mode) */
        [data-theme="dark"] {
            --bg-body: #0f0f0f;
            --bg-card: #1a1a1a;
            --bg-header: #141414;
            --bg-input: #252525;
            --text-main: #ffd700;
            --text-input: #ffd700;
            --text-muted: #b0b0b0;
            --border: #333;
            --accent: #ffb700;
            --accent-hover: #ffcc00;
            --accent-glow: rgba(255, 183, 0, 0.15);
            --result-color: #ffd700;
            --shadow: 0 20px 40px rgba(0,0,0,0.7);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Cairo', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            background-color: var(--bg-body);
            background-image: radial-gradient(circle at 50% -20%, var(--accent-glow) 0%, transparent 60%);
            background-attachment: fixed;
            color: var(--text-main);
            min-height: 100vh;
            width: 100%;
            padding-top: calc(var(--header-height) + 20px);
            padding-bottom: 20px;
            overflow-x: hidden;
            transition: background-color 0.3s, color 0.3s;
        }

        /* === Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ (Header) === */
        .main-header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: var(--header-height);
            background-color: var(--bg-header);
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            z-index: 1000;
            box-shadow: var(--shadow);
            transition: background-color 0.3s, border-color 0.3s;
        }

        /* Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø£ÙŠØ³Ø± (Ø§Ù„Ø´Ø¹Ø§Ø± + Ø§Ù„Ù†Øµ + Ø²Ø± Ø§Ù„ÙˆØ¶Ø¹) */
        .header-left {
            display: flex;
            align-items: center;
            gap: 12px; /* ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù…Ø³Ø§ÙØ© Ù‚Ù„ÙŠÙ„Ø§Ù‹ Ù„Ø§Ø³ØªÙŠØ¹Ø§Ø¨ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø£ÙƒØ¨Ø± */
        }

        .header-logo {
            width: 70px; /* ØªÙ… Ø§Ù„ØªÙƒØ¨ÙŠØ± */
            height: 70px; /* ØªÙ… Ø§Ù„ØªÙƒØ¨ÙŠØ± */
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid var(--accent); /* Ø­ÙˆØ§Ù Ø°Ù‡Ø¨ÙŠØ© */
            box-shadow: 0 0 20px var(--accent-glow); /* ØªÙˆÙ‡Ø¬ Ø°Ù‡Ø¨ÙŠ */
            /* ØªÙ…Øª Ø¥Ø²Ø§Ù„Ø© background-color Ù„Ø¬Ø¹Ù„Ù‡Ø§ Ø´ÙØ§ÙØ© */
            cursor: pointer;
            transition: transform 0.3s;
        }
        .header-logo:hover { transform: scale(1.05); }

        .brand-text {
            font-size: 1.2rem;
            font-weight: 900;
            color: var(--accent);
            text-transform: uppercase;
            letter-spacing: 1px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: none; 
        }
        
        /* Ø²Ø± ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ */
        .theme-toggle {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-main);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1.2rem;
        }
        .theme-toggle:hover {
            background-color: var(--bg-input);
            border-color: var(--accent);
            color: var(--accent);
        }

        /* Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙŠÙ…Ù†Ù‰ */
        .header-nav {
            display: flex;
            gap: 8px;
        }

        .nav-btn {
            background: rgba(128, 128, 128, 0.1);
            border: 1px solid transparent;
            color: var(--text-muted);
            padding: 8px 14px;
            border-radius: 30px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
            white-space: nowrap;
        }

        .nav-btn.active {
            background: var(--accent);
            color: #000;
            box-shadow: 0 2px 10px var(--accent-glow);
            font-weight: 800;
        }

        /* === Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© === */
        .app-container {
            width: 100%;
            max-width: 480px;
            min-height: 60vh; 
            height: auto;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 20px; 
            box-shadow: var(--shadow);
            margin: 0 auto;
            position: relative;
            display: flex;
            flex-direction: column; 
            overflow: visible;
            transition: background-color 0.3s, border-color 0.3s;
        }

        h1 {
            text-align: center;
            font-weight: 900;
            font-size: 1.5rem; 
            margin-bottom: 15px; 
            color: var(--text-main);
            text-shadow: 0 0 10px var(--accent-glow);
            letter-spacing: -0.5px;
            flex-shrink: 0;
            user-select: none;
        }

        /* --- Views --- */
        .view-section {
            display: none;
            flex-direction: column;
            height: auto;
            overflow: visible;
            position: relative;
        }
        
        .view-section.active-view {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .scrollable-area {
            display: block;
            overflow: visible;
            height: auto;
            width: 100%;
        }
        
        /* --- Currency Styles --- */
        .content-wrapper {
            display: flex;
            flex-direction: column;
            padding-bottom: 20px;
        }
        
        .input-group { margin-bottom: 10px; position: relative; }
        
        label {
            display: block;
            color: var(--text-muted);
            font-size: 0.8rem;
            margin-bottom: 4px;
            font-weight: 600;
            padding-right: 5px;
            user-select: none;
        }

        .styled-input {
            width: 100%;
            background: var(--bg-input);
            border: 2px solid var(--border);
            color: var(--text-input);
            padding: 12px 15px; 
            border-radius: var(--radius);
            font-size: 1.4rem;
            font-weight: 700;
            font-family: var(--font-numbers);
            direction: ltr;
            text-align: right;
            outline: none;
            transition: border-color 0.3s;
            -moz-appearance: textfield;
        }
        
        .styled-input::-webkit-outer-spin-button,
        .styled-input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .styled-input:focus {
            border-color: var(--accent);
            box-shadow: 0 0 0 3px var(--accent-glow);
        }

        .custom-select-wrapper { position: relative; user-select: none; width: 100%; z-index: 100; }
        .custom-select { position: relative; display: flex; flex-direction: column; }
        
        .custom-select__trigger {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 15px; 
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-main);
            background: var(--bg-input);
            border: 2px solid var(--border);
            border-radius: var(--radius);
            cursor: pointer;
            transition: all 0.3s;
        }

        .custom-select__trigger:hover { border-color: var(--border); }
        .custom-select.open .custom-select__trigger {
            border-color: var(--accent);
            box-shadow: 0 0 0 3px var(--accent-glow);
        }

        .arrow { font-size: 0.7rem; color: var(--text-muted); transition: transform 0.3s; pointer-events: none;}
        .custom-select.open .arrow { transform: rotate(180deg); }

        .custom-options {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            width: 90%;
            max-width: 450px;
            max-height: 80vh;
            background: var(--bg-card);
            border: 2px solid var(--accent);
            border-radius: 20px;
            box-shadow: 0 0 0 1000px rgba(0,0,0,0.8);
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
            transition: all 0.3s cubic-bezier(0.165, 0.84, 0.44, 1);
            z-index: 99999;
            display: flex;
            flex-direction: column;
            padding-bottom: 10px;
            overflow-y: auto;
        }
        .custom-select.open .custom-options {
            transform: translate(-50%, -50%) scale(1);
            opacity: 1;
            visibility: visible;
            pointer-events: all;
        }
        .custom-options::-webkit-scrollbar { width: 8px; }
        .custom-options::-webkit-scrollbar-track { background: var(--bg-input); }
        .custom-options::-webkit-scrollbar-thumb { background-color: var(--accent); border-radius: 4px; }

        .currency-search-container {
            padding: 10px 15px;
            background: var(--bg-card);
            position: sticky;
            top: 0;
            z-index: 10;
            border-bottom: 1px solid var(--border);
        }
        .currency-search {
            width: 100%;
            background: var(--bg-input);
            border: 1px solid var(--border);
            color: var(--text-input);
            padding: 10px 15px;
            border-radius: 12px;
            font-size: 0.9rem;
            font-family: 'Cairo', sans-serif;
            outline: none;
            transition: 0.3s;
        }
        .currency-search:focus { border-color: var(--accent); }

        .custom-option {
            position: relative;
            display: flex;
            align-items: center;
            padding: 15px 20px;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.2s;
            border-bottom: 1px solid rgba(128,128,128,0.1);
        }
        .custom-option:last-child { border-bottom: none; }
        .custom-option:hover {
            background-color: var(--accent-glow);
            color: var(--text-main);
            padding-right: 25px;
        }
        .custom-option.selected {
            color: var(--accent);
            background-color: var(--accent-glow);
        }

        .flag-icon {
            width: 32px;
            height: 24px;
            object-fit: contain; 
            border-radius: 4px;
            margin-left: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
            background-color: #333;
            pointer-events: none;
        }

        .currency-text { flex: 1; text-align: right; direction: ltr; pointer-events: none;}
        .ar-name {
            display: block;
            color: var(--text-muted);
            font-size: 0.8em;
            margin-top: 3px;
            direction: rtl; 
            text-align: right;
        }

        .swap-row { display: flex; justify-content: center; margin: -5px 0 10px 0; position: relative; z-index: 1; }
        .btn-swap {
            width: 40px;
            height: 40px; 
            border-radius: 50%;
            background: var(--bg-card);
            border: 2px solid var(--border);
            color: var(--text-muted);
            font-size: 1.1rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }
        .btn-swap:hover {
            color: var(--accent);
            border-color: var(--accent);
            transform: rotate(180deg) scale(1.1);
            box-shadow: 0 0 15px var(--accent-glow);
        }

        /* --- Footer Area --- */
        .footer-actions {
            margin-top: 20px; 
        }

        .btn-convert {
            width: 100%;
            padding: 14px; 
            background: linear-gradient(135deg, var(--accent), var(--accent-hover));
            color: #000;
            border: none;
            border-radius: var(--radius);
            font-size: 1.1rem;
            font-weight: 800;
            cursor: pointer;
            margin-top: 5px;
            box-shadow: 0 5px 15px -5px var(--accent-glow);
            transition: transform 0.2s, box-shadow 0.2s;
            user-select: none;
        }
        .btn-convert:active { transform: scale(0.98); }

        .result-box {
            margin-top: 10px; 
            padding-top: 15px;
            border-top: 1px solid var(--border);
            text-align: center;
            opacity: 0;
            transform: translateY(15px);
            transition: all 0.5s;
        }
        .result-box.show { opacity: 1; transform: translateY(0); }
        
        .result-amount {
            font-size: 2.2rem; 
            font-weight: 900;
            color: var(--result-color);
            line-height: 1.1;
            margin-bottom: 2px;
            text-shadow: 0 0 20px var(--accent-glow);
            font-family: var(--font-numbers);
            word-break: break-all;
        }
        .rate-display {
            font-size: 0.8rem;
            color: var(--text-muted);
            background: var(--bg-input);
            padding: 4px 12px;
            border-radius: 50px;
            border: 1px solid var(--border);
            display: inline-block;
            margin-top: 5px;
        }

        /* --- Metal Styles --- */
        .refresh-btn {
            background: transparent;
            border: 1px solid var(--accent);
            color: var(--accent);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.8rem;
            cursor: pointer;
            margin-bottom: 15px;
            align-self: flex-end;
            display: flex;
            align-items: center;
            gap: 5px;
            user-select: none;
        }
        .refresh-btn:hover { background: var(--accent); color: #000; }
        .refresh-btn svg { width: 14px; height: 14px; pointer-events: none; }

        .metal-card {
            background: var(--bg-input);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 20px;
            margin-bottom: 20px;
            text-align: center;
            user-select: none;
        }
        .metal-card.gold { border-color: #ffd700; }
        .metal-card.silver { border-color: #c0c0c0; }
        
        .metal-icon { font-size: 2rem; margin-bottom: 10px; }
        .metal-title { font-size: 1.2rem; font-weight: 700; margin-bottom: 15px; }
        .gold .metal-title { color: #ffd700; }
        .silver .metal-title { color: #e0e0e0; }

        .price-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid rgba(128,128,128,0.1);
            font-family: var(--font-numbers);
            font-weight: 600;
        }
        .price-row:last-child { border-bottom: none; }
        .price-label { color: var(--text-muted); font-size: 0.9rem; }
        .price-value { font-size: 1rem; color: var(--text-main); }

        /* --- Crypto Styles --- */
        .crypto-list { display: flex; flex-direction: column; gap: 10px; padding-bottom: 20px; }
        .crypto-item {
            background: var(--bg-input);
            padding: 15px;
            border-radius: var(--radius);
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid var(--border);
            user-select: none;
        }
        .crypto-info { display: flex; align-items: center; gap: 12px; }
        .crypto-icon { width: 36px; height: 36px; border-radius: 50%; background: #333; pointer-events: none;}
        .crypto-name { font-weight: 700; font-size: 1rem; color: var(--text-main); }
        .crypto-symbol { color: var(--text-muted); font-size: 0.8rem; }
        .crypto-price { 
            font-family: var(--font-numbers); 
            font-weight: 700; 
            color: var(--accent);
        }

        .live-indicator {
            font-size: 0.7rem;
            color: #0f0;
            display: flex;
            align-items: center;
            gap: 4px;
            margin-bottom: 10px;
            animation: blink 1.5s infinite;
        }
        @keyframes blink { 50% { opacity: 0.5; } }

        /* --- Utils --- */
        .loader {
            display: none;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(0,0,0,0.3);
            border-radius: 50%;
            border-top-color: #000;
            animation: spin 0.8s linear infinite;
            margin: 20px auto;
        }
        @keyframes spin { 100% { transform: rotate(360deg); } }

        .toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: var(--bg-card);
            color: var(--text-main);
            border: 1px solid var(--accent);
            padding: 10px 20px;
            border-radius: 50px;
            font-weight: 700;
            box-shadow: 0 10px 25px rgba(0,0,0,0.5);
            transition: 0.4s;
            z-index: 100000;
            font-size: 0.85rem;
            pointer-events: none;
        }
        .toast.active { transform: translateX(-50%) translateY(0); }

        .close-modal {
            text-align: center;
            padding: 15px;
            color: var(--accent);
            font-size: 1.2rem;
            cursor: pointer;
            border-bottom: 1px solid var(--border);
            margin-bottom: 0px;
            flex-shrink: 0;
            user-select: none;
        }
        .close-modal:active { opacity: 0.7; }
        
        .section-loader {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            color: var(--text-muted);
            min-height: 200px;
        }
        
        @media (min-width: 400px) {
            .brand-text { display: block; }
        }
    </style>
</head>
<body>

    <!-- Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
    <header class="main-header">
        <!-- Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø£ÙŠØ³Ø± (Ø§Ù„Ø´Ø¹Ø§Ø± ÙˆØ§Ù„Ù† ÙˆØ²Ø± Ø§Ù„ÙˆØ¶Ø¹) -->
        <div class="header-left">
            <img src="https://i.postimg.cc/SKQnQvN0/f178c888-f04a-4103-832e-d9c0e717cc2d.png" class="header-logo" alt="Mintly Logo" onclick="switchView('home', document.querySelector('.nav-btn'))">
            <span class="brand-text">Mintly World</span>
        </div>
        
        <!-- Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
        <nav class="header-nav">
            <button class="nav-btn active" onclick="switchView('home', this)">Ø¹Ù…Ù„Ø§Øª</button>
            <button class="nav-btn" onclick="switchView('gold', this)">Ø§Ù„Ø°Ù‡Ø¨</button>
            <button class="nav-btn" onclick="switchView('crypto', this)">Ø§Ù„Ø±Ù‚Ù…ÙŠØ©</button>
        </nav>

        <!-- Ø²Ø± ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ -->
        <button class="theme-toggle" id="themeToggle" onclick="toggleTheme()">
            <span id="themeIcon">â˜€ï¸</span>
        </button>
    </header>

    <!-- Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
    <div class="app-container">

        <!-- Ø§Ù„Ù‚Ø³Ù… 1: Ø§Ù„Ù…Ø­ÙˆÙ„ -->
        <div id="view-home" class="view-section active-view">
            <h1>Ù…Ø­ÙˆÙ„ Ø§Ù„Ø¹Ù…Ù„Ø§Øª</h1>
            
            <div class="scrollable-area">
                <div class="content-wrapper">
                    <div class="input-group">
                        <label>Ø§Ù„Ù…Ø¨Ù„Øº (Amount)</label>
                        <input type="number" id="amount" class="styled-input" value="1" placeholder="0.00" lang="en" inputmode="decimal">
                    </div>

                    <div class="input-group">
                        <label>Ù…Ù† (From)</label>
                        <div class="custom-select-wrapper">
                            <div class="custom-select" id="fromSelect">
                                <div class="custom-select__trigger">
                                    <span>Ø§Ø®ØªØ± Ø§Ù„Ø¹Ù…Ù„Ø©</span>
                                    <span class="arrow">â–¼</span>
                                </div>
                                <div class="custom-options"></div>
                            </div>
                        </div>
                    </div>

                    <div class="swap-row">
                        <button class="btn-swap" id="swapBtn">â‡„</button>
                    </div>

                    <div class="input-group">
                        <label>Ø¥Ù„Ù‰ (To)</label>
                        <div class="custom-select-wrapper">
                            <div class="custom-select" id="toSelect">
                                <div class="custom-select__trigger">
                                    <span>Ø§Ø®ØªØ± Ø§Ù„Ø¹Ù…Ù„Ø©</span>
                                    <span class="arrow">â–¼</span>
                                </div>
                                <div class="custom-options"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="footer-actions">
                <button class="btn-convert" id="convertBtn">
                    <span class="btn-text">ØªØ­ÙˆÙŠÙ„</span>
                    <div class="loader" id="loader"></div>
                </button>

                <div class="result-box" id="resultBox">
                    <div class="result-amount" id="resultAmount" lang="en">0.00</div>
                    <div class="rate-display" id="rateDisplay" lang="en">1 USD = --- USD</div>
                </div>
            </div>
        </div>

        <!-- Ø§Ù„Ù‚Ø³Ù… 2: Ø§Ù„Ø°Ù‡Ø¨ ÙˆØ§Ù„ÙØ¶Ø© -->
        <div id="view-gold" class="view-section">
            <div style="display:flex; flex-direction:column; width:100%;">
                <div style="flex-shrink: 0;">
                    <h1>Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ù…Ø¹Ø§Ø¯Ù†</h1>
                    
                    <button class="refresh-btn" onclick="fetchGoldAndSilver()">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 4v6h-6"></path><path d="M1 20v-6h6"></path><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path></svg>
                        <span>ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¢Ù†</span>
                    </button>
                </div>

                <div id="gold-loader-container" class="section-loader" style="display:none">
                    <div class="loader" style="display:block; border-top-color:var(--accent); border-color:rgba(212, 160, 23, 0.3);"></div>
                    <div style="margin-right:10px">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„   ...</div>
                </div>

                <div class="scrollable-area">
                    <div id="gold-content">
                        <!-- Ù‚Ø³Ù… Ø§Ù„Ø°Ù‡Ø¨ -->
                        <div class="metal-card gold">
                            <div class="metal-icon">ğŸ¥‡</div>
                            <div class="metal-title">Ø§Ù„Ø°Ù‡Ø¨ (Gold)</div>
                            
                            <div class="price-row">
                                <span class="price-label">Ø£ÙˆÙ†ØµØ© (Ø¯ÙˆÙ„Ø§Ø±)</span>
                                <span class="price-value" id="gold-ounce-usd">---</span>
                            </div>
                            <div class="price-row">
                                <span class="price-label">ØºØ±Ø§Ù… 24 (Ø¯ÙˆÙ„Ø§Ø±)</span>
                                <span class="price-value" id="gold-gram-usd">---</span>
                            </div>
                            <div class="price-row" style="margin-top:5px; border-top:1px dashed var(--border); padding-top:5px;">
                                <span class="price-label">Ø£ÙˆÙ†ØµØ© (Ù„ÙŠØ±Ø© Ø³ÙˆØ±ÙŠØ©)</span>
                                <span class="price-value" id="gold-ounce-syp" style="color:var(--accent)">---</span>
                            </div>
                            <div class="price-row">
                                <span class="price-label">ØºØ±Ø§Ù… 21 (Ù„ÙŠØ±Ø© Ø³ÙˆØ±ÙŠØ©)</span>
                                <span class="price-value" id="gold-21-syp" style="color:var(--accent)">---</span>
                            </div>
                        </div>

                        <!-- Ù‚Ø³Ù… Ø§Ù„ÙØ¶Ø© -->
                        <div class="metal-card silver">
                            <div class="metal-icon">ğŸ¥ˆ</div>
                            <div class="metal-title">Ø§Ù„ÙØ¶Ø© (Silver)</div>
                            
                            <div class="price-row">
                                <span class="price-label">Ø£ÙˆÙ†ØµØ© (Ø¯ÙˆÙ„Ø§Ø±)</span>
                                <span class="price-value" id="silver-ounce-usd">---</span>
                            </div>
                            <div class="price-row">
                                <span class="price-label">ØºØ±Ø§Ù… (Ø¯ÙˆÙ„Ø§Ø±)</span>
                                <span class="price-value" id="silver-gram-usd">---</span>
                            </div>
                        </div>
                        
                        <p style="text-align:center; font-size:0.7rem; color:var(--text-muted); margin-top:20px; line-height:1.6; padding-bottom: 20px;">
                            * Ø§Ù„Ø£Ø³Ø¹Ø§Ø± ØªÙØ¬Ù„Ø¨ Ù…Ù† Ù…ØµØ§Ø¯Ø± Ø¯Ù‚ÙŠÙ‚Ø©.<br>
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ø§Ù„Ù‚Ø³Ù… 3: Ø§Ù„Ø¹Ù…Ù„Ø§Øª Ø§Ù„Ø±Ù‚Ù…ÙŠØ© -->
        <div id="view-crypto" class="view-section">
            <div style="display:flex; flex-direction:column; width:100%;">
                <div style="flex-shrink: 0;">
                    <h1>Ø§Ù„Ø¹Ù…Ù„Ø§Øª Ø§Ù„Ø±Ù‚Ù…ÙŠØ©</h1>
                    
                    <div class="live-indicator" style="display:none" id="crypto-live-indicator">
                        <div style="width:8px; height:8px; background:#0f0; border-radius:50%"></div>
                        <span>Ø§Ù„Ø£Ø³Ø¹Ø§Ø± ØªØªØ­Ø¯Ø« ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹</span>
                    </div>

                    <div id="crypto-loader-container" class="section-loader" style="display:none">
                        <div class="loader" style="display:block; border-top-color:var(--accent); border-color:rgba(212, 160, 23, 0.3);"></div>
                        <div style="margin-right:10px">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„ ...</div>
                    </div>
                </div>

                <div class="scrollable-area">
                    <div class="crypto-list" id="cryptoListContainer">
                        <div style="text-align:center; padding:20px; color:var(--text-muted);"> Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª... </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <div class="toast" id="toast">Ø±Ø³Ø§Ù„Ø© ØªÙ†Ø¨ÙŠÙ‡</div>

    <script>
        // === Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø­ÙÙˆØ¸ ===
        const savedTheme = localStorage.getItem('theme') || 'dark';
        document.documentElement.setAttribute('data-theme', savedTheme);
        updateThemeIcon(savedTheme);

        // === ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ ===
        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            updateThemeIcon(newTheme);
        }

        function updateThemeIcon(theme) {
            const iconSpan = document.getElementById('themeIcon');
            if (theme === 'dark') {
                iconSpan.textContent = 'ğŸŒ™';
            } else {
                iconSpan.textContent = 'â˜€ï¸';
            }
        }

        // === APIs ===
        const API_ENDPOINTS = [
            "https://api.exchangerate-api.com/v4/latest/", 
            "https://open.er-api.com/v6/latest/"
        ];

        let selectedFrom = 'USD';
        let selectedTo = 'EUR'; 
        let cachedRates = {}; 
        let sypRate = 0; 
        let cryptoInterval = null;

        // DOM Elements
        const amountInput = document.getElementById('amount');
        const convertBtn = document.getElementById('convertBtn');
        const swapBtn = document.getElementById('swapBtn');
        const loader = document.getElementById('loader');
        const btnText = document.querySelector('.btn-text');
        const resultBox = document.getElementById('resultBox');
        const resultAmount = document.getElementById('resultAmount');
        const rateDisplay = document.getElementById('rateDisplay');
        const toast = document.getElementById('toast');

        const arabicNames = {
            AED: "Ø¯Ø±Ù‡Ù… Ø¥Ù…Ø§Ø±Ø§ØªÙŠ", AFN: "Ø£ÙØºØ§Ù†ÙŠ", ALL: "Ù„ÙŠÙƒ Ø£Ù„Ø¨Ø§Ù†ÙŠ", AMD: "Ø¯Ø±Ø§Ù… Ø£Ø±Ù…ÙŠÙ†ÙŠ", ANG: "Ø¬ÙŠÙ„Ø¯Ø± Ù‡ÙˆÙ„Ù†Ø¯ÙŠ", AOA: "ÙƒÙˆØ§Ù†Ø²Ø§ Ø£Ù†ØºÙˆÙ„ÙŠ", ARS: "Ø¨ÙŠØ²Ùˆ Ø£Ø±Ø¬Ù†ØªÙŠÙ†ÙŠ", AUD: "Ø¯ÙˆÙ„Ø§Ø± Ø£Ø³ØªØ±Ø§Ù„ÙŠ", AWG: "Ø¬ÙŠÙ„Ø¯Ø± Ø£Ø±ÙˆØ¨ÙŠ", AZN: "Ù…Ø§Ù†Ø§Øª Ø£Ø°Ø±Ø¨ÙŠØ¬Ø§Ù†ÙŠ",
            BAM: "Ù…Ø§Ø±Ùƒ Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªØ­ÙˆÙŠÙ„", BBD: "Ø¯ÙˆÙ„Ø§Ø± Ø¨Ø±Ø¨Ø§Ø¯ÙˆØ³ÙŠ", BDT: "ØªØ§ÙƒØ§ Ø¨Ù†ØºÙ„Ø§Ø¯ÙŠØ´ÙŠ", BGN: "Ù„ÙŠÙ Ø¨Ù„ØºØ§Ø±ÙŠ", BHD: "Ø¯ÙŠÙ†Ø§Ø± Ø¨Ø­Ø±ÙŠÙ†ÙŠ", BIF: "ÙØ±Ù†Ùƒ Ø¨Ø±ÙˆÙ†Ø¯ÙŠ", BMD: "Ø¯ÙˆÙ„Ø§Ø± Ø¨Ø±Ù…ÙˆØ¯ÙŠ", BND: "Ø¯ÙˆÙ„Ø§Ø± Ø¨Ø±ÙˆÙ†ÙŠ", BOB: "Ø¨ÙˆÙ„ÙŠÙÙŠØ§Ù†Ùˆ", BRL: "Ø±ÙŠØ§Ù„ Ø¨Ø±Ø§Ø²ÙŠÙ„ÙŠ", BSD: "Ø¯ÙˆÙ„Ø§Ø± Ø¨Ù‡Ø§Ù…ÙŠ", BTC: "Ø¨ÙŠØªÙƒÙˆÙŠÙ†", BTN: "Ù†ØºÙ„ØªØ±ÙˆÙ… Ø¨ÙˆØªØ§Ù†ÙŠ", BWP: "Ø¨ÙˆÙ„Ø§ Ø¨ÙˆØªØ³ÙˆØ§Ù†ÙŠ", BYN: "Ø±ÙˆØ¨Ù„ Ø¨Ù„Ø§Ø±ÙˆØ³ÙŠ", BZD: "Ø¯ÙˆÙ„Ø§Ø± Ø¨Ù„ÙŠØ²ÙŠ",
            CAD: "Ø¯ÙˆÙ„Ø§Ø± ÙƒÙ†Ø¯ÙŠ", CDF: "ÙØ±Ù†Ùƒ ÙƒÙˆÙ†ØºÙˆÙ„ÙŠ", CHF: "ÙØ±Ù†Ùƒ Ø³ÙˆÙŠØ³Ø±ÙŠ", CLP: "Ø¨ÙŠØ²Ùˆ ØªØ´ÙŠÙ„ÙŠ", CNY: "ÙŠÙˆØ§Ù† ØµÙŠÙ†ÙŠ", COP: "Ø¨ÙŠØ²Ùˆ ÙƒÙˆÙ„ÙˆÙ…Ø¨ÙŠ", CRC: "ÙƒÙˆÙ„ÙˆÙ† ÙƒÙˆØ³ØªØ§Ø±ÙŠÙƒÙŠ", CUC: "Ø¨ÙŠØ²Ùˆ ÙƒÙˆØ¨ÙŠ Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªØ­ÙˆÙŠÙ„", CUP: "Ø¨ÙŠØ²Ùˆ ÙƒÙˆØ¨ÙŠ", CVE: "Ø¥Ø³ÙƒÙˆØ¯Ùˆ Ø±Ø£Ø³ Ø£Ø®Ø¶Ø±ÙŠ", CZK: "ÙƒÙˆØ±ÙˆÙ†Ø§ ØªØ´ÙŠÙƒÙŠØ©",
            DJF: "ÙØ±Ù†Ùƒ Ø¬ÙŠØ¨ÙˆØªÙŠ", DKK: "ÙƒØ±ÙˆÙ†Ø© Ø¯Ø§Ù†Ù…Ø±ÙƒÙŠØ©", DOP: "Ø¨ÙŠØ²Ùˆ Ø¯ÙˆÙ…ÙŠÙ†ÙŠÙƒÙŠ", DZD: "Ø¯ÙŠÙ†Ø§Ø± Ø¬Ø²Ø§Ø¦Ø±ÙŠ",
            EGP: "Ø¬Ù†ÙŠÙ‡ Ù…ØµØ±ÙŠ", ERN: "Ù†Ø§Ù‚ÙØ§ Ø¥Ø±ÙŠØªØ±ÙŠ", ETB: "Ø¨ÙŠØ± Ø¥Ø«ÙŠÙˆØ¨ÙŠ", EUR: "ÙŠÙˆØ±Ùˆ",
            FJD: "Ø¯ÙˆÙ„Ø§Ø± ÙÙŠØ¬ÙŠ", FKP: "Ø¬Ù†ÙŠÙ‡ Ø¬Ø²Ø± ÙÙˆÙƒÙ„Ø§Ù†Ø¯", GBP: "Ø¬Ù†ÙŠÙ‡ Ø¥Ø³ØªØ±Ù„ÙŠÙ†ÙŠ", GEL: "Ù„Ø§Ø±ÙŠ Ø¬ÙˆØ±Ø¬ÙŠ", GGP: "Ø¬Ù†ÙŠÙ‡ ØºØ±Ù†Ø²ÙŠ", GHS: "Ø³ÙŠØ¯ÙŠ ØºØ§Ù†ÙŠ", GIP: "Ø¬Ù†ÙŠÙ‡ Ø¬Ø¨Ù„ Ø·Ø§Ø±Ù‚", GMD: "Ø¯Ø§Ù„Ø§Ø³ÙŠ ØºØ§Ù…Ø¨ÙŠ", GNF: "ÙØ±Ù†Ùƒ ØºÙŠÙ†ÙŠ", GTQ: "ÙƒÙŠØªØ²Ø§Ù„ ØºÙˆØ§ØªÙŠÙ…Ø§Ù„ÙŠ", GYD: "Ø¯ÙˆÙ„Ø§Ø± ØºÙŠØ§Ù†Ø§",
            HKD: "Ø¯ÙˆÙ„Ø§Ø± Ù‡ÙˆÙ†Øº ÙƒÙˆÙ†ØºÙŠ", HNL: "Ù„Ù…Ø¨ÙŠØ±Ø§ Ù‡Ù†Ø¯ÙˆØ±Ø§Ø³ÙŠØ©", HRK: "ÙƒÙˆÙ†Ø§ ÙƒØ±ÙˆØ§ØªÙŠØ©", HTG: "ØºÙˆØ±Ø¯ Ù‡Ø§ÙŠØªÙŠ", HUF: "ÙÙˆØ±Ù†Øª Ù…Ø¬Ø±ÙŠ",
            IDR: "Ø±ÙˆØ¨ÙŠØ© Ø¥Ù†Ø¯ÙˆÙ†ÙŠØ³ÙŠØ©", IMP: "Ø¬Ù†ÙŠÙ‡ Ù…Ø§Ù†", INR: "Ø±ÙˆØ¨ÙŠØ© Ù‡Ù†Ø¯ÙŠØ©", IQD: "Ø¯ÙŠÙ†Ø§Ø± Ø¹Ø±Ø§Ù‚ÙŠ", IRR: "Ø±ÙŠØ§Ù„ Ø¥ÙŠØ±Ø§Ù†ÙŠ", ISK: "ÙƒØ±ÙˆÙ†Ø© Ø¢ÙŠØ³Ù„Ù†Ø¯ÙŠØ©", JEP: "Ø¬Ù†ÙŠÙ‡ Ø¬ÙŠØ±Ø²ÙŠ", JMD: "Ø¯ÙˆÙ„Ø§Ø± Ø¬Ø§Ù…Ø§ÙŠÙƒÙŠ", JOD: "Ø¯ÙŠÙ†Ø§Ø± Ø£Ø±Ø¯Ù†ÙŠ", JPY: "ÙŠÙ† ÙŠØ§Ø¨Ø§Ù†ÙŠ",
            KES: "Ø´Ù„Ù† ÙƒÙŠÙ†ÙŠ", KGS: "Ø³ÙˆÙ… Ù‚Ø±ØºÙŠØ²Ø³ØªØ§Ù†ÙŠ", KHR: "Ø±ÙŠÙŠÙ„ ÙƒÙ…Ø¨ÙˆØ¯ÙŠ", KMF: "ÙØ±Ù†Ùƒ Ù‚Ù…Ø±ÙŠ", KPW: "ÙˆÙˆÙ† ÙƒÙˆØ±ÙŠ Ø´Ù…Ø§Ù„ÙŠ", KRW: "ÙˆÙˆÙ† ÙƒÙˆØ±ÙŠ Ø¬Ù†ÙˆØ¨ÙŠ", KWD: "Ø¯ÙŠÙ†Ø§Ø± ÙƒÙˆÙŠØªÙŠ", KYD: "Ø¯ÙˆÙ„Ø§Ø± Ø¬Ø²Ø± ÙƒØ§ÙŠÙ…Ø§Ù†", KZT: "ØªÙŠÙ†Øº ÙƒØ§Ø²Ø§Ø®Ø³ØªØ§Ù†ÙŠ",
            LAK: "ÙƒÙŠØ¨ Ù„Ø§ÙˆØ³ÙŠ", LBP: "Ù„ÙŠØ±Ø© Ù„Ø¨Ù†Ø§Ù†ÙŠØ©", LKR: "Ø±ÙˆØ¨ÙŠØ© Ø³Ø±ÙŠÙ„Ø§Ù†ÙƒÙŠØ©", LRD: "Ø¯ÙˆÙ„Ø§Ø± Ù„ÙŠØ¨ÙŠØ±ÙŠ", LSL: "Ù„ÙˆØªÙŠ Ù„ÙŠØ³ÙˆØªÙˆ", LYD: "Ø¯ÙŠÙ†Ø§Ø± Ù„ÙŠØ¨ÙŠ",
            MAD: "Ø¯Ø±Ù‡Ù… Ù…ØºØ±Ø¨ÙŠ", MDL: "Ù„ÙŠÙˆ Ù…ÙˆÙ„Ø¯ÙˆÙÙŠ", MGA: "Ø£Ø±ÙŠØ§Ø±ÙŠ Ù…Ø¯ØºØ´Ù‚Ø±ÙŠ", MKD: "Ø¯ÙŠÙ†Ø§Ø± Ù…Ù‚Ø¯ÙˆÙ†ÙŠ", MMK: "ÙƒÙŠØ§Øª Ù…ÙŠØ§Ù†Ù…Ø§Ø±ÙŠ", MNT: "ØªÙˆØºØ±ÙŠÙƒ Ù…Ù†ØºÙˆÙ„ÙŠ", MOP: "Ø¨Ø§ØªØ§ÙƒØ§ Ù…Ø§ÙƒØ§ÙˆÙŠ", MRU: "Ø£ÙˆÙ‚ÙŠØ© Ù…ÙˆØ±ÙŠØªØ§Ù†ÙŠØ©", MUR: "Ø±ÙˆØ¨ÙŠØ© Ù…ÙˆØ±ÙŠØ´ÙŠÙˆØ³ÙŠØ©", MVR: "Ø±ÙˆÙÙŠÙŠØ© Ù…Ø§Ù„Ø¯ÙŠÙÙŠØ©", MWK: "ÙƒÙˆØ§Ø´Ø§ Ù…Ù„Ø§ÙˆÙŠ", MXN: "Ø¨ÙŠØ²Ùˆ Ù…ÙƒØ³ÙŠÙƒÙŠ", MYR: "Ø±ÙŠÙ†ØºÙŠØª Ù…Ø§Ù„ÙŠØ²ÙŠ", MZN: "Ù…ÙŠØªÙƒØ§Ù„ Ù…ÙˆØ²Ù…Ø¨ÙŠÙ‚ÙŠ",
            NAD: "Ø¯ÙˆÙ„Ø§Ø± Ù†Ø§Ù…ÙŠØ¨ÙŠ", NGN: "Ù†Ø§ÙŠØ±Ø§ Ù†ÙŠØ¬ÙŠØ±ÙŠ", NIO: "ÙƒÙˆØ±Ø¯ÙˆØ¨Ø§ Ù†ÙŠÙƒØ§Ø±Ø§ØºÙˆØ§", NOK: "ÙƒØ±ÙˆÙ†Ø© Ù†Ø±ÙˆÙŠØ¬ÙŠØ©", NPR: "Ø±ÙˆØ¨ÙŠØ© Ù†ÙŠØ¨Ø§Ù„ÙŠØ©", NZD: "Ø¯ÙˆÙ„Ø§Ø± Ù†ÙŠÙˆØ²ÙŠÙ„Ù†Ø¯ÙŠ",
            OMR: "Ø±ÙŠØ§Ù„ Ø¹Ù…Ø§Ù†ÙŠ",
            PAB: "Ø¨Ø§Ù„Ø¨ÙˆØ§ Ø¨Ù†Ù…ÙŠ", PEN: "Ø³ÙˆÙ„ Ø¨ÙŠØ±ÙˆÙÙŠ", PGK: "ÙƒÙŠÙ†Ø§ Ø¨Ø§Ø¨ÙˆØ§ ØºÙŠÙ†ÙŠØ§ Ø¬Ø¯ÙŠØ¯Ø©", PHP: "Ø¨ÙŠØ²Ùˆ ÙÙ„Ø¨ÙŠÙ†ÙŠ", PKR: "Ø±ÙˆØ¨ÙŠØ© Ø¨Ø§ÙƒØ³ØªØ§Ù†ÙŠØ©", PLN: "Ø²Ù„ÙˆØªÙŠ Ø¨ÙˆÙ„Ù†Ø¯ÙŠ", PYG: "ØºÙˆØ§Ø±Ø§Ù†ÙŠ Ø¨Ø§Ø±Ø§ØºÙˆØ§ÙŠ",
            QAR: "Ø±ÙŠØ§Ù„ Ù‚Ø·Ø±ÙŠ",
            RON: "Ù„ÙŠÙˆ Ø±ÙˆÙ…Ø§Ù†ÙŠ", RSD: "Ø¯ÙŠÙ†Ø§Ø± ØµØ±Ø¨ÙŠ", RUB: "Ø±ÙˆØ¨Ù„ Ø±ÙˆØ³ÙŠ", RWF: "ÙØ±Ù†Ùƒ Ø±ÙˆØ§Ù†Ø¯ÙŠ",
            SAR: "Ø±ÙŠØ§Ù„ Ø³Ø¹ÙˆØ¯ÙŠ", SBD: "Ø¯ÙˆÙ„Ø§Ø± Ø¬Ø²Ø± Ø³Ù„ÙŠÙ…Ø§Ù†", SCR: "Ø±ÙˆØ¨ÙŠØ© Ø³ÙŠØ´Ù„ÙŠØ©", SDG: "Ø¬Ù†ÙŠÙ‡ Ø³ÙˆØ¯Ø§Ù†ÙŠ", SEK: "ÙƒØ±ÙˆÙ†Ø© Ø³ÙˆÙŠØ¯ÙŠØ©", SGD: "Ø¯ÙˆÙ„Ø§Ø± Ø³Ù†ØºØ§ÙÙˆØ±ÙŠ", SHP: "Ø¬Ù†ÙŠÙ‡ Ø³Ø§Ù†Øª Ù‡ÙŠÙ„ÙŠÙ†", SLL: "Ù„ÙŠÙˆÙ† Ø³ÙŠØ±Ø§Ù„ÙŠÙˆÙ†", SOS: "Ø´Ù„Ù† ØµÙˆÙ…Ø§Ù„ÙŠ", SPL: "Ù„ÙˆØ¨ÙŠØºÙˆ", SRD: "Ø¯ÙˆÙ„Ø§Ø± Ø³ÙˆØ±ÙŠÙ†Ø§Ù…ÙŠ", STN: "Ø¯ÙˆØ¨Ø±Ø§ Ø³Ø§Ùˆ ØªÙˆÙ…ÙŠ", SVC: "ÙƒÙˆÙ„ÙˆÙ† Ø³Ù„ÙØ§Ø¯ÙˆØ±ÙŠ", SYP: "Ù„ÙŠØ±Ø© Ø³ÙˆØ±ÙŠØ©", SZL: "Ù„ÙŠÙ„Ø§Ù†Ø¬ÙŠÙ†ÙŠ Ø³ÙˆØ§Ø²ÙŠ",
            THB: "Ø¨Ø§Øª ØªØ§ÙŠÙ„Ø§Ù†Ø¯ÙŠ", TJS: "Ø³ÙˆÙ…ÙˆÙ†ÙŠ Ø·Ø§Ø¬ÙŠÙƒÙŠ", TMT: "Ù…Ù†Ø§Øª ØªØ±ÙƒÙ…Ø§Ù†Ø³ØªØ§Ù†ÙŠ", TND: "Ø¯ÙŠÙ†Ø§Ø± ØªÙˆÙ†Ø³ÙŠ", TOP: "Ø¨Ø§Ù†ØºØ§ ØªÙˆÙ†ØºÙŠ", TRY: "Ù„ÙŠØ±Ø© ØªØ±ÙƒÙŠØ©", TTD: "Ø¯ÙˆÙ„Ø§Ø± ØªØ±ÙŠÙ†ÙŠØ¯Ø§Ø¯ÙŠ", TVD: "Ø¯ÙˆÙ„Ø§Ø± ØªÙˆÙØ§Ù„Ùˆ", TWD: "Ø¯ÙˆÙ„Ø§Ø± ØªØ§ÙŠÙˆØ§Ù†ÙŠ Ø¬Ø¯ÙŠØ¯", TZS: "Ø´Ù„Ù† ØªÙ†Ø²Ø§Ù†ÙŠ",
            UAH: "Ù‡Ø±ÙŠÙÙ†ÙŠØ§ Ø£ÙˆÙƒØ±Ø§Ù†ÙŠØ©", UGX: "Ø´Ù„Ù† Ø£ÙˆØºÙ†Ø¯ÙŠ", USD: "Ø¯ÙˆÙ„Ø§Ø± Ø£Ù…Ø±ÙŠÙƒÙŠ", UYU: "Ø¨ÙŠØ²Ùˆ Ø£ÙˆØ±ÙˆØºÙˆØ§ÙŠ", UZS: "Ø³ÙˆÙ… Ø£ÙˆØ²Ø¨ÙƒØ³ØªØ§Ù†ÙŠ",
            VEF: "Ø¨ÙˆÙ„ÙŠÙØ§Ø± ÙÙ†Ø²ÙˆÙŠÙ„ÙŠ", VND: "Ø¯ÙˆÙ†Ø¬ ÙÙŠØªÙ†Ø§Ù…ÙŠ", VUV: "ÙØ§ØªÙˆ ÙØ§Ù†ÙˆØ§ØªÙˆ",
            WST: "ØªØ§Ù„Ø§ Ø³Ø§Ù…ÙˆØ§",
            XAF: "ÙØ±Ù†Ùƒ CFA ÙˆØ³Ø· Ø£ÙØ±ÙŠÙ‚ÙŠØ§", XAG: "Ø£ÙˆÙ†ØµØ© ÙØ¶Ø©", XAU: "Ø£ÙˆÙ†ØµØ© Ø°Ù‡Ø¨", XBA: "ÙˆØ­Ø¯Ø© Ù…Ø±ÙƒØ¨Ø© Ø£ÙˆØ±ÙˆØ¨ÙŠØ©", XBB: "ÙˆØ­Ø¯Ø© Ù…Ø§Ù„ÙŠØ© Ø£ÙˆØ±ÙˆØ¨ÙŠØ©", XBC: "ÙˆØ­Ø¯Ø© Ø­Ø³Ø§Ø¨ÙŠØ© Ø£ÙˆØ±ÙˆØ¨ÙŠØ© (XBC)", XBD: "ÙˆØ­Ø¯Ø© Ø­Ø³Ø§Ø¨ÙŠØ© Ø£ÙˆØ±ÙˆØ¨ÙŠØ© (XBD)", XCD: "Ø¯ÙˆÙ„Ø§Ø± Ø´Ø±Ù‚ Ø§Ù„ÙƒØ§Ø±ÙŠØ¨ÙŠ", XDR: "Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ø³Ø­Ø¨ Ø§Ù„Ø®Ø§ØµØ©", XOF: "ÙØ±Ù†Ùƒ CFA ØºØ±Ø¨ Ø£ÙØ±ÙŠÙ‚ÙŠØ§", XPD: "Ø£ÙˆÙ†ØµØ© Ø¨Ø§Ù„Ø§Ø¯ÙŠÙˆÙ…", XPF: "ÙØ±Ù†Ùƒ Ø³ÙŠ Ø¥Ù Ø¨ÙŠ", XPT: "Ø£ÙˆÙ†ØµØ© Ø¨Ù„Ø§ØªÙŠÙ†", XSU: "Ø³ÙˆÙƒØ±", XTS: "Ø±Ù…Ø² Ø¹Ù…Ù„Ø© Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±", XUA: "ÙˆØ­Ø¯Ø© Ø­Ø³Ø§Ø¨ÙŠØ© Ø£Ø¯ÙŠØ³ Ø£Ø¨Ø§Ø¨Ø§", XXX: "Ø¹Ù…Ù„Ø© ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙØ©",
            YER: "Ø±ÙŠØ§Ù„ ÙŠÙ…Ù†ÙŠ",
            ZAR: "Ø±Ø§Ù†Ø¯ Ø¬Ù†ÙˆØ¨ Ø£ÙØ±ÙŠÙ‚ÙŠ", ZMW: "ÙƒÙˆØ§Ø´Ø§ Ø²Ø§Ù…Ø¨ÙŠ", ZWL: "Ø¯ÙˆÙ„Ø§Ø± Ø²ÙŠÙ…Ø¨Ø§Ø¨ÙˆÙŠ"
        };

        async function fetchRatesWithFallback(baseCurrency) {
            for (const apiUrl of API_ENDPOINTS) {
                try {
                    const response = await fetch(`${apiUrl}${baseCurrency}`, { cache: 'no-store' });
                    if (!response.ok) throw new Error("Network response was not ok");
                    const data = await response.json();
                    if (data.rates) {
                        return data.rates;
                    }
                } catch (error) {
                    console.warn(`API Error from ${apiUrl}, trying next...`);
                    continue;
                }
            }
            return null;
        }

        function switchView(viewName, btnElement) {
            if (viewName !== 'crypto' && cryptoInterval) {
                clearInterval(cryptoInterval);
                cryptoInterval = null;
                document.getElementById('crypto-live-indicator').style.display = 'none';
            }

            document.querySelectorAll('.view-section').forEach(el => el.classList.remove('active-view'));
            document.querySelectorAll('.nav-btn').forEach(el => el.classList.remove('active'));

            document.getElementById(`view-${viewName}`).classList.add('active-view');
            
            if(btnElement) {
                btnElement.classList.add('active');
            } else {
                const index = ['home', 'gold', 'crypto'].indexOf(viewName);
                if(index >= 0) document.querySelectorAll('.nav-btn')[index].classList.add('active');
            }

            if(viewName === 'gold') {
                fetchGoldAndSilver();
            }
            if(viewName === 'crypto') {
                initCrypto();
            }
        }

        document.addEventListener('DOMContentLoaded', async () => {
            await initCurrencies();
            
            convertBtn.addEventListener('click', performConvert);
            amountInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') performConvert();
            });
            swapBtn.addEventListener('click', () => {
                swapBtn.style.transform = "rotate(180deg) scale(1.1)";
                setTimeout(() => swapBtn.style.transform = "rotate(0deg) scale(1)", 300);
                const temp = selectedFrom;
                selectOption('fromSelect', selectedTo);
                selectOption('toSelect', temp);
                performConvert();
            });
        });

        async function initCurrencies() {
            let currencyList = {};
            try {
                const rates = await fetchRatesWithFallback('USD');
                if (rates) {
                    Object.keys(rates).forEach(code => currencyList[code] = code);
                    cachedRates = rates;
                    sypRate = rates['SYP'];
                    initCustomSelects(currencyList);
                } else {
                    throw new Error("All APIs failed");
                }
            } catch (e) {
                showToast("ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Øª");
            }
        }

        function initCustomSelects(currencies) {
            const codes = Object.keys(currencies).filter(code => code !== 'ILS').sort();
            
            const getIconUrl = (code) => {
                if (code === 'XAU') return 'https://cdn-icons-png.flaticon.com/512/6146/6146333.png';
                if (code === 'XAG') return 'https://cdn-icons-png.flaticon.com/512/6146/6146332.png';
                if (code === 'BTC') return 'https://assets.coincap.io/assets/icons/btc@2x.png';
                if (code === 'ETH') return 'https://assets.coincap.io/assets/icons/eth@2x.png';
                if (code === 'XDR') return 'https://cdn-icons-png.flaticon.com/512/3550/3550317.png';
                if (code === 'XAF' || code === 'XOF' || code === 'XCD' || code === 'XPF') return 'https://cdn-icons-png.flaticon.com/512/2693/2693502.png';
                if (code.startsWith('X') && code !== 'XXX') return 'https://cdn-icons-png.flaticon.com/512/3135/3135715.png';
                if (code === 'ANG') return 'https://flagcdn.com/w40/nl.png';
                const countryCode = code.substring(0, 2).toLowerCase();
                return `https://flagcdn.com/w40/${countryCode}.png`;
            };

            const createListHTML = () => {
                let closeBtn = `<div class="close-modal">âœ• Ø¥ØºÙ„Ø§Ù‚</div>`;
                let searchHTML = `<div class="currency-search-container"><input type="text" class="currency-search" placeholder="Ø¨Ø­Ø« (Ø§Ø³Ù… Ø£Ùˆ Ø±Ù…Ø²)..."></div>`;
                
                let list = codes.map(code => {
                    const engName = currencies[code];
                    const araName = arabicNames[code] || engName;
                    const iconUrl = getIconUrl(code);
                    return `<span class="custom-option" data-value="${code}">
                            <img src="${iconUrl}" class="flag-icon">
                            <div class="currency-text"><strong>${code}</strong> <span class="ar-name">${araName}</span></div>
                        </span>`;
                }).join('');
                return closeBtn + searchHTML + list;
            };

            const listHTML = createListHTML();
            setupCustomSelect('fromSelect', listHTML, (val) => { selectedFrom = val; });
            setupCustomSelect('toSelect', listHTML, (val) => { selectedTo = val; });

            selectOption('fromSelect', 'USD');
            selectOption('toSelect', 'EUR'); 
        }

        function setupCustomSelect(elementId, htmlContent, callback) {
            const wrapper = document.getElementById(elementId);
            const trigger = wrapper.querySelector('.custom-select__trigger span:first-child');
            const optionsContainer = wrapper.querySelector('.custom-options');
            optionsContainer.innerHTML = htmlContent;

            const closeModal = () => {
                wrapper.classList.remove('open');
                wrapper.parentElement.style.zIndex = 1;
            };

            const openModal = () => {
                wrapper.classList.add('open');
                wrapper.parentElement.style.zIndex = 1000;
                optionsContainer.scrollTop = 0;
                const searchInput = optionsContainer.querySelector('.currency-search');
                if(searchInput) {
                    searchInput.value = '';
                    const options = optionsContainer.querySelectorAll('.custom-option');
                    options.forEach(opt => opt.style.display = 'flex');
                    searchInput.focus();
                }
            };

            wrapper.querySelector('.custom-select__trigger').addEventListener('click', function(e) {
                e.stopPropagation();
                document.querySelectorAll('.custom-select').forEach(el => {
                    if (el !== wrapper) {
                        el.classList.remove('open');
                        el.parentElement.style.zIndex = 1;
                    }
                });
                if (wrapper.classList.contains('open')) closeModal();
                else openModal();
            });

            wrapper.querySelector('.close-modal').addEventListener('click', closeModal);
            const searchInput = optionsContainer.querySelector('.currency-search');
            if(searchInput) {
                searchInput.addEventListener('input', (e) => {
                    const term = e.target.value.toLowerCase();
                    const options = optionsContainer.querySelectorAll('.custom-option');
                    options.forEach(opt => {
                        const code = opt.dataset.value.toLowerCase();
                        const arName = opt.querySelector('.ar-name').textContent;
                        if (code.includes(term) || arName.includes(term)) opt.style.display = 'flex';
                        else opt.style.display = 'none';
                    });
                });
            }

            wrapper.querySelectorAll('.custom-option').forEach(option => {
                option.addEventListener('click', function() {
                    const value = this.getAttribute('data-value');
                    const araName = this.querySelector('.ar-name').textContent;
                    const imgSrc = this.querySelector('img').src;

                    trigger.innerHTML = `
                        <div style="display:flex; align-items:center;">
                            <img src="${imgSrc}" class="flag-icon" style="width:18px; height:13px; margin-left:8px;">
                            ${value} - ${araName}
                        </div>
                    `;
                    callback(value);
                    closeModal();
                });
            });
        }

        function selectOption(elementId, code) {
            const wrapper = document.getElementById(elementId);
            const option = wrapper.querySelector(`.custom-option[data-value="${code}"]`);
            if (option) option.click();
        }

        window.addEventListener('click', function(e) {
            if (!e.target.closest('.custom-select')) {
                document.querySelectorAll('.custom-select').forEach(el => {
                    el.classList.remove('open');
                    el.parentElement.style.zIndex = 1;
                });
            }
        });

        async function performConvert() {
            const amount = parseFloat(amountInput.value);
            if (isNaN(amount) || amount <= 0) {
                showToast("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­");
                return;
            }

            resultBox.classList.remove('show');
            setLoading(true);

            try {
                const rates = await fetchRatesWithFallback(selectedFrom);
                
                if (rates) {
                    cachedRates = rates;
                    if(rates['SYP']) sypRate = rates['SYP'];

                    if (rates[selectedTo]) {
                        const rate = rates[selectedTo];
                        const total = amount * rate;
                        setTimeout(() => {
                            animateResult(total, rate);
                            resultBox.classList.add('show');
                        }, 200);
                    } else {
                        showToast("Ø§Ù„Ø¹Ù…Ù„Ø© ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…Ø©");
                    }
                } else {
                    showToast("ÙØ´Ù„ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ØµØ§Ø¯Ø±");
                }
            } catch (error) {
                console.error(error);
                showToast("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.");
            } finally {
                setLoading(false);
            }
        }

        function animateResult(targetValue, rate) {
            const araTarget = arabicNames[selectedTo] || selectedTo;
            rateDisplay.textContent = `1 ${selectedFrom} = ${rate.toFixed(4)} ${selectedTo}`;
            
            const duration = 1500;
            const startValue = 0;
            const startTime = performance.now();

            function update(currentTime) {
                const elapsed = currentTime - startTime;
                const progress = Math.min(elapsed / duration, 1);
                const ease = 1 - Math.pow(1 - progress, 3);
                const currentVal = startValue + (targetValue - startValue) * ease;
                const formatted = new Intl.NumberFormat('en-US', {
                    minimumFractionDigits: 2,
                    maximumFractionDigits: 2
                }).format(currentVal);
                resultAmount.textContent = formatted;
                if (progress < 1) requestAnimationFrame(update);
            }
            requestAnimationFrame(update);
        }

        function setLoading(isLoading) {
            if (isLoading) {
                convertBtn.disabled = true;
                btnText.style.display = 'none';
                loader.style.display = 'block';
            } else {
                convertBtn.disabled = false;
                btnText.style.display = 'block';
                loader.style.display = 'none';
            }
        }

        function showToast(msg) {
            toast.textContent = msg;
            toast.classList.add('active');
            setTimeout(() => toast.classList.remove('active'), 3000);
        }

        async function fetchGoldAndSilver() {
            const loaderContainer = document.getElementById('gold-loader-container');
            const content = document.getElementById('gold-content');
            
            loaderContainer.style.display = 'flex';
            content.style.display = 'none';

            let goldUsdPerOunce = null;
            let silverUsdPerOunce = null;

            try {
                const rates = await fetchRatesWithFallback('USD');
                
                if (rates) {
                    if(rates['SYP']) {
                        sypRate = rates['SYP'];
                        cachedRates = rates;
                    }
                    goldUsdPerOunce = rates['XAU'];
                    silverUsdPerOunce = rates['XAG'];
                }

                if (!goldUsdPerOunce) {
                    try {
                        const paxgRes = await fetch('https://api.binance.com/api/v3/ticker/price?symbol=PAXGUSDT');
                        const paxgData = await paxgRes.json();
                        goldUsdPerOunce = parseFloat(paxgData.price);
                        showToast("ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø°Ù‡Ø¨ Ø¹Ø¨Ø± PAXG");
                    } catch (e) { console.error("PAXG fallback failed"); }
                }

                if (goldUsdPerOunce) {
                    const goldUsdPerGram = goldUsdPerOunce / 31.1035;
                    const goldSypPerOunce = goldUsdPerOunce * sypRate;
                    const goldSypPerGram = goldSypPerOunce / 31.1035;
                    const gold21SypPerGram = goldSypPerGram * (21/24);

                    document.getElementById('gold-ounce-usd').textContent = `$${goldUsdPerOunce.toLocaleString(undefined, {minimumFractionDigits:2})}`;
                    document.getElementById('gold-gram-usd').textContent = `$${goldUsdPerGram.toFixed(2)}`;
                    
                    document.getElementById('gold-ounce-syp').textContent = sypRate ? goldSypPerOunce.toLocaleString('en-US', {maximumFractionDigits:0}) : '---';
                    document.getElementById('gold-21-syp').textContent = sypRate ? gold21SypPerGram.toLocaleString('en-US', {maximumFractionDigits:0}) : '---';

                    if (silverUsdPerOunce) {
                        const silverUsdPerGram = silverUsdPerOunce / 31.1035;
                        document.getElementById('silver-ounce-usd').textContent = `$${silverUsdPerOunce.toFixed(2)}`;
                        document.getElementById('silver-gram-usd').textContent = `$${silverUsdPerGram.toFixed(3)}`;
                        document.querySelector('.metal-card.silver').style.display = 'block';
                    } else {
                        document.querySelector('.metal-card.silver').style.display = 'none';
                        showToast("Ø§Ù„ÙØ¶Ø© ØºÙŠØ± Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹");
                    }

                    loaderContainer.style.display = 'none';
                    content.style.display = 'block';
                } else {
                    throw new Error("Gold failed");
                }

            } catch (error) {
                loaderContainer.style.display = 'none';
                content.style.display = 'block';
                showToast("ÙØ´Ù„ ØªØ­Ø¯ÙŠØ« Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ù…Ø¹Ø§Ø¯Ù†");
                console.error(error);
            }
        }

        async function fetchCryptoDataArray() {
            const response = await fetch('https://api.binance.com/api/v3/ticker/price', { cache: 'no-store' });
            if(!response.ok) throw new Error("API Error");
            const data = await response.json();
            const targetSymbols = ['BTCUSDT', 'ETHUSDT', 'BNBUSDT', 'SOLUSDT', 'XRPUSDT', 'DOGEUSDT', 'ADAUSDT', 'TRXUSDT', 'TONUSDT', 'PEPEUSDT'];
            return data.filter(item => targetSymbols.includes(item.symbol));
        }

        function buildCryptoHTML(coinsData) {
            const container = document.getElementById('cryptoListContainer');
            const cryptoNames = {
                'BTC': 'Ø¨ÙŠØªÙƒÙˆÙŠÙ†', 'ETH': 'Ø¥ÙŠØ«ÙŠØ±ÙŠÙˆÙ…', 'BNB': 'Ø¨ÙŠÙ†Ø§Ù†Ø³ ÙƒÙˆÙŠÙ†',
                'SOL': 'Ø³ÙˆÙ„Ø§Ù†Ø§', 'XRP': 'Ø±ÙŠØ¨Ù„', 'DOGE': 'Ø¯ÙˆØ¬ ÙƒÙˆÙŠÙ†',
                'ADA': 'ÙƒØ§Ø±Ø¯Ø§Ù†Ùˆ', 'TRX': 'ØªØ±ÙˆÙ†', 'TON': 'ØªÙˆÙ† ÙƒÙˆÙŠÙ†', 'PEPE': 'Ø¨ÙŠØ¨ÙŠ'
            };

            let html = '';
            coinsData.forEach(coin => {
                const symbol = coin.symbol.replace('USDT', '');
                const name = cryptoNames[symbol] || symbol;
                const price = parseFloat(coin.price);
                const iconUrl = `https://assets.coincap.io/assets/icons/${symbol.toLowerCase()}@2x.png`;
                
                let formattedPrice = price < 1 ? price.toFixed(6) : price.toLocaleString('en-US', {minimumFractionDigits:2, maximumFractionDigits:2});

                html += `
                <div class="crypto-item">
                    <div class="crypto-info">
                        <img src="${iconUrl}" class="crypto-icon" onerror="this.src='https://cdn-icons-png.flaticon.com/512/6146/6146332.png'">
                        <div>
                            <div class="crypto-name">${name}</div>
                            <div class="crypto-symbol">${symbol}/USDT</div>
                        </div>
                    </div>
                    <div class="crypto-price" id="crypto-price-${symbol}">$${formattedPrice}</div>
                </div>
                `;
            });

            container.innerHTML = html;
        }

        async function updateCryptoPrices() {
            try {
                const coinsData = await fetchCryptoDataArray();
                
                coinsData.forEach(coin => {
                    const symbol = coin.symbol.replace('USDT', '');
                    const price = parseFloat(coin.price);
                    const priceEl = document.getElementById(`crypto-price-${symbol}`);

                    if (priceEl) {
                        let formattedPrice = price < 1 ? price.toFixed(6) : price.toLocaleString('en-US', {minimumFractionDigits:2, maximumFractionDigits:2});
                        priceEl.textContent = `$${formattedPrice}`;
                    }
                });
            } catch (error) {
                console.warn("Auto-update failed", error);
            }
        }

        async function initCrypto() {
            const container = document.getElementById('cryptoListContainer');
            const loaderContainer = document.getElementById('crypto-loader-container');
            const liveIndicator = document.getElementById('crypto-live-indicator');

            if(cryptoInterval) clearInterval(cryptoInterval);

            const isAlreadyBuilt = document.getElementById('crypto-price-BTC') !== null;

            if (!isAlreadyBuilt) {
                loaderContainer.style.display = 'flex';
                container.innerHTML = '';
                try {
                    const data = await fetchCryptoDataArray();
                    buildCryptoHTML(data);
                    
                    loaderContainer.style.display = 'none';
                    liveIndicator.style.display = 'flex';
                } catch (e) {
                    loaderContainer.style.display = 'none';
                    container.innerHTML = '<div style="text-align:center; padding:20px; color:var(--accent)">ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„</div>';
                    return;
                }
            } else {
                liveIndicator.style.display = 'flex';
            }

            cryptoInterval = setInterval(updateCryptoPrices, 100);
        }

    </script>
</body>
</html>
